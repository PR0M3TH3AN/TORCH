# Decisions: dashboard/index.html innerHTML Migration

## Strategy
We are migrating `innerHTML` to safe DOM APIs (`textContent`, `createElement`, `appendChild`, `replaceChildren`).

## Decisions

1.  **Helper Function**: Created `dashboard/domUtils.js` to host `escapeHtml`. Although we are moving to `createElement` which inherently escapes text in `textContent`, `escapeHtml` is useful if we ever need to set attributes that might be sensitive (though less critical there) or if we fallback to `innerHTML` (which we are trying to avoid).
    *   *Update*: Actually, for `lockGrid`, reconstructing the entire card with `createElement` is verbose but safer. We will do that. `escapeHtml` might not be needed if we strictly use `textContent`, but it's good to have available.

2.  **`summaryBar`**:
    *   **Before**: Template literal with `innerHTML`.
    *   **After**: `document.createElement('div')`, loop through cards, create elements, set classes and `textContent`.

3.  **`lockGrid`**:
    *   **Before**: Complex template literal with `innerHTML`.
    *   **After**: `createLockCard(lock)` function that builds the DOM tree for a card. This ensures no unescaped user data (agent name, cadence, etc.) can be injected.
    *   **Risk**: CSS classes must be copied exactly.

4.  **Clearing Content**:
    *   **Before**: `el.innerHTML = ''`.
    *   **After**: `el.replaceChildren()`. This is faster and safer.
