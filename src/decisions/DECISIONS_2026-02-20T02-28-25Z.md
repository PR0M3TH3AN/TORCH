# Decisions: Decompose src/lock-ops.mjs

## 1. Duplicate Internal Helpers (`withTimeout`, `relayListLabel`)
- **Context:** Both `src/lock-ops.mjs` and the new `src/lock-publisher.mjs` need `withTimeout` and `relayListLabel`.
- **Option A:** Move them to `src/utils.mjs`.
- **Option B:** Duplicate them in the new file.
- **Decision:** **Option B (Duplicate)**.
- **Rationale:** The prompt emphasizes "One file per PR only" and "Do not decompose multiple files". Modifying `src/utils.mjs` would touch a second existing file, potentially expanding the scope and risk. Duplicating these small helpers keeps the changes isolated to the decomposition of `src/lock-ops.mjs` and its new children.

## 2. Shared Constants
- **Context:** Extracted files need constants from `src/constants.mjs` and `src/torch-config.mjs`.
- **Decision:** Import them directly in the new files.
- **Rationale:** Standard module practice.

## 3. Class Extraction
- **Context:** `RelayHealthManager` and `LockPublisher` are large, distinct classes.
- **Decision:** Extract each into its own file (`src/relay-health-manager.mjs`, `src/lock-publisher.mjs`).
- **Rationale:** Improves modularity and reduces the size of `src/lock-ops.mjs` significantly.
