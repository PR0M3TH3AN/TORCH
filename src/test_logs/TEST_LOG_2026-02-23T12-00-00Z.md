---
agent: onboarding-audit-agent
cadence: daily
run-start: 2026-02-23T12:00:00Z
---

# Test Log ‚Äî onboarding-audit-agent

**Command:** `npm install`
**Result:**
```

up to date, audited 156 packages in 829ms

38 packages are looking for funding
  run `npm fund` for details

4 vulnerabilities (1 moderate, 3 high)

To address all issues, run:
  npm audit fix

Run `npm audit` for details.
```

**Command:** `npm run build`
**Result:**
```

> torch-lock@0.1.0 build
> node build.mjs

Generating npm package tarball...
npm notice
npm notice üì¶  torch-lock@0.1.0
npm notice Tarball Contents
npm notice 1.1kB LICENSE
npm notice 11.7kB README.md
npm notice 26.0kB TORCH.md
npm notice 1.1kB assets/favicon.svg
npm notice 1.1kB assets/logo.svg
npm notice 90B bin/torch-lock.mjs
npm notice 25.1kB dashboard/app.js
npm notice 870B dashboard/domUtils.js
npm notice 10.3kB dashboard/index.html
npm notice 11.0kB dashboard/styles.css
npm notice 2.0kB migrations/create_memories_table.sql
npm notice 3.5kB package.json
npm notice 3.0kB scripts/check-file-size.mjs
npm notice 3.1kB scripts/check-innerhtml.mjs
npm notice 4.1kB scripts/memory/retrieve.mjs
npm notice 4.3kB scripts/memory/store.mjs
npm notice 2.8kB scripts/test-audit/run-flaky-check.mjs
npm notice 2.2kB scripts/test-audit/run-static-analysis.mjs
npm notice 778B skills/README.md
npm notice 1.4kB skills/torch-basics.md
npm notice 6.2kB src/cli-parser.mjs
npm notice 3.3kB src/cmd-backup.mjs
npm notice 3.6kB src/cmd-check.mjs
npm notice 4.2kB src/cmd-complete.mjs
npm notice 2.9kB src/cmd-list.mjs
npm notice 3.1kB src/cmd-proposal.mjs
npm notice 8.0kB src/cmd-remove.mjs
npm notice 964B src/cmd-rollback.mjs
npm notice 3.7kB src/constants.mjs
npm notice 9.4kB src/dashboard.mjs
npm notice 190B src/errors.mjs
npm notice 15.3kB src/lib.mjs
npm notice 2.9kB src/lock-error-classifier.mjs
npm notice 5.6kB src/lock-ops.mjs
npm notice 16.0kB src/lock-publisher.mjs
npm notice 2.4kB src/lock-utils.mjs
npm notice 26.4kB src/ops.mjs
npm notice 1.9kB src/prompts/daily-scheduler.md
npm notice 15.5kB src/prompts/daily/audit-agent.md
npm notice 10.7kB src/prompts/daily/ci-health-agent.md
npm notice 16.1kB src/prompts/daily/const-refactor-agent.md
npm notice 4.0kB src/prompts/daily/content-audit-agent.md
npm notice 14.0kB src/prompts/daily/decompose-agent.md
npm notice 15.2kB src/prompts/daily/deps-security-agent.md
npm notice 12.1kB src/prompts/daily/design-system-audit-agent.md
npm notice 10.4kB src/prompts/daily/docs-agent.md
npm notice 10.5kB src/prompts/daily/docs-alignment-agent.md
npm notice 12.6kB src/prompts/daily/docs-code-investigator.md
npm notice 4.5kB src/prompts/daily/governance-agent.md
npm notice 14.3kB src/prompts/daily/innerhtml-migration-agent.md
npm notice 11.9kB src/prompts/daily/known-issues-agent.md
npm notice 11.1kB src/prompts/daily/load-test-agent.md
npm notice 5.6kB src/prompts/daily/log-fixer-agent.md
npm notice 10.5kB src/prompts/daily/onboarding-audit-agent.md
npm notice 13.9kB src/prompts/daily/perf-agent.md
npm notice 3.1kB src/prompts/daily/protocol-research-agent.md
npm notice 11.6kB src/prompts/daily/scheduler-update-agent.md
npm notice 7.9kB src/prompts/daily/style-agent.md
npm notice 3.1kB src/prompts/daily/test-audit-agent.md
npm notice 10.9kB src/prompts/daily/todo-triage-agent.md
npm notice 3.8kB src/prompts/daily/torch-garbage-collection-agent.md
npm notice 287B src/prompts/memory/condense_prompt.txt
npm notice 263B src/prompts/memory/prune_prompt.txt
npm notice 324B src/prompts/memory/score_prompt.txt
npm notice 475B src/prompts/memory/summarize_prompt.txt
npm notice 10.6kB src/prompts/META_PROMPTS.md
npm notice 1.3kB src/prompts/roster.json
npm notice 16.5kB src/prompts/scheduler-flow.md
npm notice 2.5kB src/prompts/weekly-scheduler.md
npm notice 10.5kB src/prompts/weekly/bug-reproducer-agent.md
npm notice 6.6kB src/prompts/weekly/builder-agent.md
npm notice 9.3kB src/prompts/weekly/changelog-agent.md
npm notice 13.8kB src/prompts/weekly/dead-code-agent.md
npm notice 3.5kB src/prompts/weekly/feature-proposer-agent.md
npm notice 9.9kB src/prompts/weekly/frontend-console-debug-agent.md
npm notice 11.6kB src/prompts/weekly/fuzz-agent.md
npm notice 12.1kB src/prompts/weekly/perf-deepdive-agent.md
npm notice 11.5kB src/prompts/weekly/perf-optimization-agent.md
npm notice 5.6kB src/prompts/weekly/plan-agent.md
npm notice 3.3kB src/prompts/weekly/pr-review-agent.md
npm notice 4.8kB src/prompts/weekly/prompt-fixer-agent.md
npm notice 5.7kB src/prompts/weekly/prompt-gap-analysis-agent.md
npm notice 5.6kB src/prompts/weekly/prompt-maintenance-agent.md
npm notice 6.5kB src/prompts/weekly/prompt-safety-agent.md
npm notice 5.6kB src/prompts/weekly/proposal-triage-agent.md
npm notice 14.6kB src/prompts/weekly/race-condition-agent.md
npm notice 9.4kB src/prompts/weekly/refactor-agent.md
npm notice 2.9kB src/prompts/weekly/repo-fit-agent.md
npm notice 3.3kB src/prompts/weekly/smoke-agent.md
npm notice 15.3kB src/prompts/weekly/telemetry-agent.md
npm notice 13.3kB src/prompts/weekly/test-coverage-agent.md
npm notice 6.2kB src/prompts/weekly/ui-ux-agent.md
npm notice 10.8kB src/prompts/weekly/weekly-synthesis-agent.md
npm notice 10.4kB src/relay-health-manager.mjs
npm notice 8.8kB src/relay-health.mjs
npm notice 3.9kB src/roster.mjs
npm notice 11.8kB src/services/governance/index.js
npm notice 7.2kB src/services/memory/cache.js
npm notice 4.8kB src/services/memory/embedder.js
npm notice 2.0kB src/services/memory/feature-flags.js
npm notice 5.9kB src/services/memory/formatter.js
npm notice 22.2kB src/services/memory/index.js
npm notice 11.0kB src/services/memory/ingestor.js
npm notice 11.2kB src/services/memory/pruner.js
npm notice 8.4kB src/services/memory/retriever.js
npm notice 9.3kB src/services/memory/scheduler.js
npm notice 5.6kB src/services/memory/schema.js
npm notice 5.0kB src/services/memory/summarizer.js
npm notice 10.1kB src/torch-config.mjs
npm notice 2.2kB src/utils.mjs
npm notice 2.7kB torch-config.example.json
npm notice Tarball Details
npm notice name: torch-lock
npm notice version: 0.1.0
npm notice filename: torch-lock-0.1.0.tgz
npm notice package size: 218.9 kB
npm notice unpacked size: 841.3 kB
npm notice shasum: 107a5bf459b3c214d30190058455558e5136f94b
npm notice integrity: sha512-K9IdugSD+kC4p[...]bojK4VAU1xz7g==
npm notice total files: 111
npm notice
torch-lock-0.1.0.tgz
Moved torch-lock-0.1.0.tgz to dist/
Build complete! Output directory: dist/
```

**Command:** `npm test`
**Result:**
```

> torch-lock@0.1.0 test
> npm run validate:scheduler && npm run test:integration:e2e && node --test --test-timeout=30000 test/*.test.mjs test/*.test.js


> torch-lock@0.1.0 validate:scheduler
> node scripts/validate-scheduler-roster.mjs && node scripts/validate-prompt-contract.mjs && node scripts/validate-scheduler-flow-parity.mjs && npm run validate:scheduler-failure-schema

Scheduler tables, roster, and prompt filenames are in sync.
Prompt contract validated for all daily/weekly prompts.
Scheduler flow parity validated for prompts and scheduler implementation.

> torch-lock@0.1.0 validate:scheduler-failure-schema
> node --test test/scheduler-lock-failure-schema.contract.test.mjs

TAP version 13
# Subtest: scheduler lock backend failure artifact matches required frontmatter schema
ok 1 - scheduler lock backend failure artifact matches required frontmatter schema
  ---
  duration_ms: 226.716389
  type: 'test'
  ...
# Subtest: schema contract catches missing required lock-backend field
ok 2 - schema contract catches missing required lock-backend field
  ---
  duration_ms: 2.943101
  type: 'test'
  ...
# Subtest: schema contract catches misnamed lock-backend key
ok 3 - schema contract catches misnamed lock-backend key
  ---
  duration_ms: 0.939476
  type: 'test'
  ...
1..3
# tests 3
# suites 0
# pass 3
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 349.538508

> torch-lock@0.1.0 test:integration:e2e
> node --test test/scheduler-preflight-lock.e2e.test.mjs

TAP version 13
# Subtest: lock preflight e2e: successful lock writes completed status snapshot
ok 1 - lock preflight e2e: successful lock writes completed status snapshot
  ---
  duration_ms: 458.135438
  type: 'test'
  ...
# Subtest: lock preflight e2e: exit code 2 quorum failure persists failed backend status and prompt-not-started marker
ok 2 - lock preflight e2e: exit code 2 quorum failure persists failed backend status and prompt-not-started marker
  ---
  duration_ms: 107.482539
  type: 'test'
  ...
# Subtest: lock preflight e2e: non-lock failure exits failed without prompt parse/schema classification
ok 3 - lock preflight e2e: non-lock failure exits failed without prompt parse/schema classification
  ---
  duration_ms: 104.323067
  type: 'test'
  ...
1..3
# tests 3
# suites 0
# pass 3
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 754.446121
TAP version 13
# Subtest: Build artifacts verification
    # Subtest: dist directory exists
    ok 1 - dist directory exists
      ---
      duration_ms: 0.900127
      type: 'test'
      ...
    # Subtest: Critical files exist in dist
    ok 2 - Critical files exist in dist
      ---
      duration_ms: 0.460605
      type: 'test'
      ...
    # Subtest: TORCH.md content is not empty
    ok 3 - TORCH.md content is not empty
      ---
      duration_ms: 1.659388
      type: 'test'
      ...
    1..3
ok 1 - Build artifacts verification
  ---
  duration_ms: 4.619377
  type: 'test'
  ...
# Subtest: parseArgs should parse basic command
ok 2 - parseArgs should parse basic command
  ---
  duration_ms: 2.815704
  type: 'test'
  ...
# Subtest: parseArgs should parse agent and cadence
ok 3 - parseArgs should parse agent and cadence
  ---
  duration_ms: 0.438118
  type: 'test'
  ...
# Subtest: parseArgs should parse equals sign syntax
ok 4 - parseArgs should parse equals sign syntax
  ---
  duration_ms: 1.736023
  type: 'test'
  ...
# Subtest: parseArgs should parse dry-run flag
ok 5 - parseArgs should parse dry-run flag
  ---
  duration_ms: 0.624525
  type: 'test'
  ...
# Subtest: parseArgs should parse port with default
ok 6 - parseArgs should parse port with default
  ---
  duration_ms: 0.328429
  type: 'test'
  ...
# Subtest: parseArgs should parse custom port
ok 7 - parseArgs should parse custom port
  ---
  duration_ms: 0.287434
  type: 'test'
  ...
# Subtest: parseArgs should parse ignore-logs flag
ok 8 - parseArgs should parse ignore-logs flag
  ---
  duration_ms: 0.43568
  type: 'test'
  ...
# Subtest: parseArgs should parse memory flags
ok 9 - parseArgs should parse memory flags
  ---
  duration_ms: 1.583952
  type: 'test'
  ...
# Subtest: parseArgs should parse memory flags with equals
ok 10 - parseArgs should parse memory flags with equals
  ---
  duration_ms: 0.531454
  type: 'test'
  ...
# Subtest: cmdList
    # Subtest: should list active locks and identify unknown agents
    ok 1 - should list active locks and identify unknown agents
      ---
      duration_ms: 4.149577
      type: 'test'
      ...
    1..1
ok 11 - cmdList
  ---
  duration_ms: 5.439761
  type: 'suite'
  ...
# No TORCH installation detected in this directory.
# Looked for:
#   - A torch/ subdirectory containing roster.json or bin/
#   - A package.json with name "torch-lock" (root install)
# Initializing torch in /app/test-ops-remove-MIRG0S/project-force/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-remove-MIRG0S/project-force/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# No package.json found in host root. Skipping script injection.
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-namespace-agent-lock
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-namespace-agent-lock&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# The following TORCH artifacts will be removed:
#   - torch/  (TORCH install directory)
#   - torch-config.json
#   - .torch/  (prompt history)
#   - src/proposals/  (governance proposals)
#   - torch-lock npm package (via npm uninstall)
# Removing TORCH...
#   Removed torch/  (TORCH install directory)
#   Removed torch-config.json
#   Removed .torch/  (prompt history)
#   Removed src/proposals/  (governance proposals)
#   Removed empty src/ directory
#   Running npm uninstall torch-lock...
#   Uninstalled torch-lock package.
# TORCH has been completely removed from this project.
# If you used TORCH environment variables (NOSTR_LOCK_*, TORCH_*),
# remember to remove them from your shell profile or CI configuration.
# Initializing torch in /app/test-ops-remove-MIRG0S/project-runtime/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-remove-MIRG0S/project-runtime/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-namespace-agent-lock
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-namespace-agent-lock&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# No package.json found in host root. Skipping script injection.
# The following TORCH artifacts will be removed:
#   - torch/  (TORCH install directory)
#   - torch-config.json
#   - .torch/  (prompt history)
#   - .scheduler-memory/  (memory store)
#   - task-logs/  (scheduler logs)
#   - src/proposals/  (governance proposals)
#   - torch-lock npm package (via npm uninstall)
# Removing TORCH...
#   Removed torch/  (TORCH install directory)
#   Removed torch-config.json
#   Removed .torch/  (prompt history)
#   Removed .scheduler-memory/  (memory store)
#   Removed task-logs/  (scheduler logs)
#   Removed src/proposals/  (governance proposals)
#   Removed empty src/ directory
#   Running npm uninstall torch-lock...
#   Uninstalled torch-lock package.
# TORCH has been completely removed from this project.
# If you used TORCH environment variables (NOSTR_LOCK_*, TORCH_*),
# remember to remove them from your shell profile or CI configuration.
# Initializing torch in /app/test-ops-remove-MIRG0S/project-proposals/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-remove-MIRG0S/project-proposals/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# Initialization complete.
# You can now customize the files in torch/
# No package.json found in host root. Skipping script injection.
# ‚óè From torch-config.json:
#   - Hashtag: test-namespace-agent-lock
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-namespace-agent-lock&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# The following TORCH artifacts will be removed:
#   - torch/  (TORCH install directory)
#   - torch-config.json
#   - .torch/  (prompt history)
#   - src/proposals/  (governance proposals)
#   - torch-lock npm package (via npm uninstall)
# Removing TORCH...
#   Removed torch/  (TORCH install directory)
#   Removed torch-config.json
#   Removed .torch/  (prompt history)
#   Removed src/proposals/  (governance proposals)
#   Removed empty src/ directory
#   Running npm uninstall torch-lock...
#   Uninstalled torch-lock package.
# TORCH has been completely removed from this project.
# If you used TORCH environment variables (NOSTR_LOCK_*, TORCH_*),
# remember to remove them from your shell profile or CI configuration.
# Initializing torch in /app/test-ops-remove-MIRG0S/project-scripts/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-remove-MIRG0S/project-scripts/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
#   Added script: "torch:dashboard"
#   Added script: "torch:check"
#   Added script: "torch:lock"
#   Added script: "torch:health"
#   Added script: "torch:memory:list"
#   Added script: "torch:memory:inspect"
# Updated package.json with convenience scripts.
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-namespace-agent-lock
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-namespace-agent-lock&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# The following TORCH artifacts will be removed:
#   - torch/  (TORCH install directory)
#   - torch-config.json
#   - .torch/  (prompt history)
#   - src/proposals/  (governance proposals)
#   - torch:* scripts from package.json
#   - torch-lock npm package (via npm uninstall)
# Removing TORCH...
#   Removed torch/  (TORCH install directory)
#   Removed torch-config.json
#   Removed .torch/  (prompt history)
#   Removed src/proposals/  (governance proposals)
#   Removed empty src/ directory
#   Removed script: "torch:dashboard"
#   Removed script: "torch:check"
#   Removed script: "torch:lock"
#   Removed script: "torch:health"
#   Removed script: "torch:memory:list"
#   Removed script: "torch:memory:inspect"
#   Updated package.json.
#   Running npm uninstall torch-lock...
#   Uninstalled torch-lock package.
# TORCH has been completely removed from this project.
# If you used TORCH environment variables (NOSTR_LOCK_*, TORCH_*),
# remember to remove them from your shell profile or CI configuration.
# Initializing torch in /app/test-ops-remove-MIRG0S/project-cancel/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-remove-MIRG0S/project-cancel/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-namespace-agent-lock
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-namespace-agent-lock&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# The following TORCH artifacts will be removed:
#   - torch/  (TORCH install directory)
#   - torch-config.json
#   - .torch/  (prompt history)
#   - src/proposals/  (governance proposals)
#   - torch-lock npm package (via npm uninstall)
# Removal cancelled.
# No package.json found in host root. Skipping script injection.
# Initializing torch in /app/test-ops-remove-MIRG0S/project-confirm/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-remove-MIRG0S/project-confirm/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-namespace-agent-lock
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-namespace-agent-lock&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# The following TORCH artifacts will be removed:
#   - torch/  (TORCH install directory)
#   - torch-config.json
# No package.json found in host root. Skipping script injection.
#   - .torch/  (prompt history)
#   - src/proposals/  (governance proposals)
#   - torch-lock npm package (via npm uninstall)
# Removing TORCH...
#   Removed torch/  (TORCH install directory)
#   Removed torch-config.json
#   Removed .torch/  (prompt history)
#   Removed src/proposals/  (governance proposals)
#   Removed empty src/ directory
#   Running npm uninstall torch-lock...
#   Uninstalled torch-lock package.
# TORCH has been completely removed from this project.
# If you used TORCH environment variables (NOSTR_LOCK_*, TORCH_*),
# remember to remove them from your shell profile or CI configuration.
# Subtest: cmdRemove reports nothing when no TORCH installation exists
ok 12 - cmdRemove reports nothing when no TORCH installation exists
  ---
  duration_ms: 3.028828
  type: 'test'
  ...
# Subtest: cmdRemove with --force removes torch/ directory
ok 13 - cmdRemove with --force removes torch/ directory
  ---
  duration_ms: 1521.16991
  type: 'test'
  ...
# Subtest: cmdRemove removes runtime artifacts (task-logs, .scheduler-memory)
ok 14 - cmdRemove removes runtime artifacts (task-logs, .scheduler-memory)
  ---
  duration_ms: 958.719339
  type: 'test'
  ...
# Subtest: cmdRemove removes src/proposals/ and cleans empty src/
ok 15 - cmdRemove removes src/proposals/ and cleans empty src/
  ---
  duration_ms: 1011.086554
  type: 'test'
  ...
# Subtest: cmdRemove cleans torch:* scripts from host package.json
ok 16 - cmdRemove cleans torch:* scripts from host package.json
  ---
  duration_ms: 470.153435
  type: 'test'
  ...
# Subtest: cmdRemove cancels when user declines confirmation
ok 17 - cmdRemove cancels when user declines confirmation
  ---
  duration_ms: 35.367357
  type: 'test'
  ...
# Subtest: cmdRemove confirmed via mockAnswers removes artifacts
ok 18 - cmdRemove confirmed via mockAnswers removes artifacts
  ---
  duration_ms: 974.365794
  type: 'test'
  ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Authentication: enabled (Basic Auth)
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Subtest: Dashboard Authentication
    # Subtest: returns 401 when auth is required but missing
    ok 1 - returns 401 when auth is required but missing
      ---
      duration_ms: 38.574783
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Authentication: enabled (Basic Auth)
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: returns 401 when malformed auth header is provided
    ok 2 - returns 401 when malformed auth header is provided
      ---
      duration_ms: 11.659518
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Authentication: enabled (Basic Auth)
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: returns 200 when valid credentials are provided
    ok 3 - returns 200 when valid credentials are provided
      ---
      duration_ms: 12.095367
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Authentication: enabled (Basic Auth)
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: returns 401 when password has different byte length than stored credential
    ok 4 - returns 401 when password has different byte length than stored credential
      ---
      duration_ms: 15.734934
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: returns 200 when auth is disabled
    ok 5 - returns 200 when auth is disabled
      ---
      duration_ms: 6.691281
      type: 'test'
      ...
    1..5
ok 19 - Dashboard Authentication
  ---
  duration_ms: 89.250766
  type: 'test'
  ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
# Subtest: Dashboard Configuration Exposure Security
ok 20 - Dashboard Configuration Exposure Security
  ---
  duration_ms: 46.228701
  type: 'test'
  ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Authentication: DISABLED (Dashboard is public)
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Subtest: Dashboard Configuration Security
    # Subtest: sanitizes config when auth is disabled
    ok 1 - sanitizes config when auth is disabled
      ---
      duration_ms: 37.647857
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Authentication: enabled (Basic Auth)
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: sanitizes auth credentials even when authenticated
    ok 2 - sanitizes auth credentials even when authenticated
      ---
      duration_ms: 15.941743
      type: 'test'
      ...
    1..2
ok 21 - Dashboard Configuration Security
  ---
  duration_ms: 56.478732
  type: 'test'
  ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Authentication: DISABLED (Dashboard is public)
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Subtest: Dashboard Path Traversal Security Fix
    # Subtest: allows access to valid dashboard index
    ok 1 - allows access to valid dashboard index
      ---
      duration_ms: 59.617051
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Authentication: DISABLED (Dashboard is public)
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks traversal attempt: /../../etc/passwd
    ok 2 - blocks traversal attempt: /../../etc/passwd
      ---
      duration_ms: 11.16837
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Authentication: DISABLED (Dashboard is public)
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks traversal attempt: /dashboard/../../etc/passwd
    ok 3 - blocks traversal attempt: /dashboard/../../etc/passwd
      ---
      duration_ms: 13.923967
      type: 'test'
      ...
# Authentication: DISABLED (Dashboard is public)
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks traversal attempt: /dashboard/../../../etc/passwd
    ok 4 - blocks traversal attempt: /dashboard/../../../etc/passwd
      ---
      duration_ms: 10.517822
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: blocks traversal attempt: /../package.json
    ok 5 - blocks traversal attempt: /../package.json
      ---
      duration_ms: 11.809532
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: blocks traversal attempt: /dashboard/../package.json
    ok 6 - blocks traversal attempt: /dashboard/../package.json
      ---
      duration_ms: 6.351659
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: blocks traversal attempt: /dashboard/%2e%2e/package.json
    ok 7 - blocks traversal attempt: /dashboard/%2e%2e/package.json
      ---
      duration_ms: 5.106653
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# Authentication: DISABLED (Dashboard is public)
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks traversal attempt: /dashboard/%2e%2e%2fpackage.json
    ok 8 - blocks traversal attempt: /dashboard/%2e%2e%2fpackage.json
      ---
      duration_ms: 6.457169
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: blocks traversal attempt: /..%2fpackage.json
    ok 9 - blocks traversal attempt: /..%2fpackage.json
      ---
      duration_ms: 12.143579
      type: 'test'
      ...
# Authentication: DISABLED (Dashboard is public)
# (node:3097) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 SIGTERM listeners added to [process]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
# (Use `node --trace-warnings ...` to show where the warning was created)
# (node:3097) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 SIGINT listeners added to [process]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks traversal attempt: /%2e%2e%2fpackage.json
    ok 10 - blocks traversal attempt: /%2e%2e%2fpackage.json
      ---
      duration_ms: 9.645332
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# Authentication: DISABLED (Dashboard is public)
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks traversal attempt: /dashboard/..%5cpackage.json
    ok 11 - blocks traversal attempt: /dashboard/..%5cpackage.json
      ---
      duration_ms: 10.141132
      type: 'test'
      ...
# Authentication: DISABLED (Dashboard is public)
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks traversal attempt: /dashboard/..%252fpackage.json
    ok 12 - blocks traversal attempt: /dashboard/..%252fpackage.json
      ---
      duration_ms: 10.310975
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Authentication: DISABLED (Dashboard is public)
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks traversal attempt: /dashboard/....//package.json
    ok 13 - blocks traversal attempt: /dashboard/....//package.json
      ---
      duration_ms: 5.026917
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: blocks traversal attempt: /dashboard/.../package.json
    ok 14 - blocks traversal attempt: /dashboard/.../package.json
      ---
      duration_ms: 4.417445
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: blocks traversal attempt: //etc/passwd
    ok 15 - blocks traversal attempt: //etc/passwd
      ---
      duration_ms: 3.764059
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: blocks traversal attempt: /dashboard//../../etc/passwd
    ok 16 - blocks traversal attempt: /dashboard//../../etc/passwd
      ---
      duration_ms: 4.182698
      type: 'test'
      ...
    # Subtest: allows traversal within allowed paths
    ok 17 - allows traversal within allowed paths
      ---
      duration_ms: 6.342312
      type: 'test'
      ...
    1..17
ok 22 - Dashboard Path Traversal Security Fix
  ---
  duration_ms: 201.059582
  type: 'test'
  ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Authentication: DISABLED (Dashboard is public)
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Authentication: DISABLED (Dashboard is public)
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Subtest: Dashboard File Access Security
    # Subtest: allows access to dashboard assets
    ok 1 - allows access to dashboard assets
      ---
      duration_ms: 32.669811
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# Authentication: DISABLED (Dashboard is public)
# NODE_V8_COVERAGE: undefined
    # Subtest: allows access to global assets
    ok 2 - allows access to global assets
      ---
      duration_ms: 9.638339
      type: 'test'
      ...
# Authentication: DISABLED (Dashboard is public)
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: allows access to landing page
    ok 3 - allows access to landing page
      ---
      duration_ms: 6.349677
      type: 'test'
      ...
# Authentication: DISABLED (Dashboard is public)
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks access to package.json
    ok 4 - blocks access to package.json
      ---
      duration_ms: 9.261307
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: blocks access to src/dashboard.mjs
    ok 5 - blocks access to src/dashboard.mjs
      ---
      duration_ms: 5.260299
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: blocks access to random root files
    ok 6 - blocks access to random root files
      ---
      duration_ms: 4.166519
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Authentication: DISABLED (Dashboard is public)
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: allows access to torch-config.json via special handler
    ok 7 - allows access to torch-config.json via special handler
      ---
      duration_ms: 5.681004
      type: 'test'
      ...
# Authentication: DISABLED (Dashboard is public)
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
    # Subtest: blocks directory traversal attempts
    ok 8 - blocks directory traversal attempts
      ---
      duration_ms: 4.367803
      type: 'test'
      ...
# Dashboard running at http://127.0.0.1:0/dashboard/
# Serving files from /app
# Using configuration from /app
# NODE_V8_COVERAGE: undefined
# Authentication: DISABLED (Dashboard is public)
    # Subtest: responses include security headers
    ok 9 - responses include security headers
      ---
      duration_ms: 8.330814
      type: 'test'
      ...
    # Subtest: error responses include security headers
    ok 10 - error responses include security headers
      ---
      duration_ms: 7.584287
      type: 'test'
      ...
    1..10
ok 23 - Dashboard File Access Security
  ---
  duration_ms: 97.900527
  type: 'test'
  ...
# Subtest: ExitError
    # Subtest: should capture the code and message correctly
    ok 1 - should capture the code and message correctly
      ---
      duration_ms: 1.103216
      type: 'test'
      ...
    # Subtest: should be an instance of Error and ExitError
    ok 2 - should be an instance of Error and ExitError
      ---
      duration_ms: 0.261602
      type: 'test'
      ...
    # Subtest: should have a stack trace
    ok 3 - should have a stack trace
      ---
      duration_ms: 0.476354
      type: 'test'
      ...
    # Subtest: should have the correct name
    ok 4 - should have the correct name
      ---
      duration_ms: 0.184265
      type: 'test'
      ...
    1..4
ok 24 - ExitError
  ---
  duration_ms: 3.616535
  type: 'suite'
  ...
# Subtest: createProposal should throw error for disallowed target
ok 25 - createProposal should throw error for disallowed target
  ---
  duration_ms: 6.859376
  type: 'test'
  ...
# Subtest: validateProposal should return invalid for disallowed target
ok 26 - validateProposal should return invalid for disallowed target
  ---
  duration_ms: 8.823359
  type: 'test'
  ...
# Subtest: validateProposal should return valid for allowed target
ok 27 - validateProposal should return valid for allowed target
  ---
  duration_ms: 4.951965
  type: 'test'
  ...
# Subtest: Governance Service Security: Command Injection Prevention
ok 28 - Governance Service Security: Command Injection Prevention
  ---
  duration_ms: 197.235435
  type: 'test'
  ...
# Subtest: SCN-proposal-create: createProposal writes meta.json, new.md, change.diff
ok 29 - SCN-proposal-create: createProposal writes meta.json, new.md, change.diff
  ---
  duration_ms: 20.613919
  type: 'test'
  ...
# Subtest: SCN-proposal-list: listProposals returns created proposal; status filter works
ok 30 - SCN-proposal-list: listProposals returns created proposal; status filter works
  ---
  duration_ms: 3.252684
  type: 'test'
  ...
# Subtest: SCN-proposal-reject: rejectProposal marks proposal with rejected status and reason
ok 31 - SCN-proposal-reject: rejectProposal marks proposal with rejected status and reason
  ---
  duration_ms: 16.718603
  type: 'test'
  ...
# Subtest: SCN-archive-naming: applyProposal archives with timestamp_hash filename and sidecar
ok 32 - SCN-archive-naming: applyProposal archives with timestamp_hash filename and sidecar
  ---
  duration_ms: 49.970832
  type: 'test'
  ...
# Subtest: SCN-version-list: listPromptVersions returns versions newest-first with metadata
ok 33 - SCN-version-list: listPromptVersions returns versions newest-first with metadata
  ---
  duration_ms: 16.325435
  type: 'test'
  ...
# Subtest: SCN-rollback-latest: rollbackPrompt restores the most recently archived content
ok 34 - SCN-rollback-latest: rollbackPrompt restores the most recently archived content
  ---
  duration_ms: 7.081247
  type: 'test'
  ...
# Subtest: SCN-rollback-hash: rollbackPrompt --strategy <fragment> restores matching archive
ok 35 - SCN-rollback-hash: rollbackPrompt --strategy <fragment> restores matching archive
  ---
  duration_ms: 5.114231
  type: 'test'
  ...
# Initializing torch in /app/test_validation_env/valid-dir_123...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created valid-dir_123/roster.json
# Created valid-dir_123/META_PROMPTS.md
# Created valid-dir_123/scheduler-flow.md
# Created valid-dir_123/daily-scheduler.md
# Created valid-dir_123/weekly-scheduler.md
# Created 23 files in valid-dir_123/prompts/daily/
# Created 24 files in valid-dir_123/prompts/weekly/
# Created test_validation_env/valid-dir_123/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created valid-dir_123/TORCH_DASHBOARD.md
#   Added script: "torch:dashboard"
#   Added script: "torch:check"
#   Added script: "torch:lock"
#   Added script: "torch:health"
#   Added script: "torch:memory:list"
#   Added script: "torch:memory:inspect"
# Updated package.json with convenience scripts.
# Initialization complete.
# You can now customize the files in valid-dir_123/
# ‚óè From torch-config.json:
#   - Hashtag: ns-agent-lock
#   - Namespace: ns
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=ns-agent-lock&namespace=ns&relays=
# Initializing torch in /app/test_validation_env...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Skipping package.json to avoid overwriting host package.json (installing to root).
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created roster.json
# Created META_PROMPTS.md
# Created scheduler-flow.md
# Created daily-scheduler.md
# Created weekly-scheduler.md
# Created 23 files in prompts/daily/
# Created 24 files in prompts/weekly/
# Created test_validation_env/.gitignore with node_modules
# Updating existing torch-config.json...
# Saved configuration to torch-config.json
# Created TORCH_DASHBOARD.md
# Initialization complete.
# You can now customize the files in /
# ‚óè From torch-config.json:
#   - Hashtag: ns-agent-lock
#   - Namespace: ns
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=ns-agent-lock&namespace=ns&relays=
# Initializing torch in /app/test_validation_env/path/to/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created path/to/torch/roster.json
# Created path/to/torch/META_PROMPTS.md
# Created path/to/torch/scheduler-flow.md
# Created path/to/torch/daily-scheduler.md
# Created path/to/torch/weekly-scheduler.md
# Created 23 files in path/to/torch/prompts/daily/
# Created 24 files in path/to/torch/prompts/weekly/
# Created test_validation_env/path/to/torch/.gitignore with node_modules
# Updating existing torch-config.json...
# Saved configuration to torch-config.json
# Created path/to/torch/TORCH_DASHBOARD.md
#   Script "torch:dashboard" already exists, skipping.
#   Script "torch:check" already exists, skipping.
#   Script "torch:lock" already exists, skipping.
#   Script "torch:health" already exists, skipping.
#   Script "torch:memory:list" already exists, skipping.
#   Script "torch:memory:inspect" already exists, skipping.
# Initialization complete.
# You can now customize the files in path/to/torch/
# ‚óè From torch-config.json:
#   - Hashtag: ns-agent-lock
#   - Namespace: ns
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=ns-agent-lock&namespace=ns&relays=
# Subtest: cmdInit should validate install directory name
    # Subtest: should reject directory with semicolon
    ok 1 - should reject directory with semicolon
      ---
      duration_ms: 1.570211
      type: 'test'
      ...
    # Subtest: should reject directory with spaces
    ok 2 - should reject directory with spaces
      ---
      duration_ms: 0.373449
      type: 'test'
      ...
    # Subtest: should reject directory with quotes
    ok 3 - should reject directory with quotes
      ---
      duration_ms: 0.358181
      type: 'test'
      ...
    # Subtest: should reject directory with backticks
    ok 4 - should reject directory with backticks
      ---
      duration_ms: 0.310423
      type: 'test'
      ...
    # Subtest: should reject directory with $
    ok 5 - should reject directory with $
      ---
      duration_ms: 0.271592
      type: 'test'
      ...
    # Subtest: should accept valid directory names
    ok 6 - should accept valid directory names
      ---
      duration_ms: 50.825635
      type: 'test'
      ...
    # Subtest: should accept "."
    ok 7 - should accept "."
      ---
      duration_ms: 46.151924
      type: 'test'
      ...
    # Subtest: should accept nested paths with slashes
    ok 8 - should accept nested paths with slashes
      ---
      duration_ms: 48.515605
      type: 'test'
      ...
    1..8
ok 36 - cmdInit should validate install directory name
  ---
  duration_ms: 206.61221
  type: 'test'
  ...
# Subtest: src/lib.mjs
    # Subtest: cmdCheck
        # Subtest: returns correct structure with empty locks
        ok 1 - returns correct structure with empty locks
          ---
          duration_ms: 2.896921
          type: 'test'
          ...
        # Subtest: identifies locked agents
        ok 2 - identifies locked agents
          ---
          duration_ms: 0.628076
          type: 'test'
          ...
        # Subtest: excludes paused agents
        ok 3 - excludes paused agents
          ---
          duration_ms: 0.694203
          type: 'test'
          ...
        # Subtest: identifies unknown locked agents
        ok 4 - identifies unknown locked agents
          ---
          duration_ms: 0.754923
          type: 'test'
          ...
        # Subtest: suppresses relay query loggers when quiet mode is enabled
        ok 5 - suppresses relay query loggers when quiet mode is enabled
          ---
          duration_ms: 0.830875
          type: 'test'
          ...
        1..5
    ok 1 - cmdCheck
      ---
      duration_ms: 7.158009
      type: 'suite'
      ...
    # Subtest: cmdLock
        # Subtest: successfully locks an available agent
        ok 1 - successfully locks an available agent
          ---
          duration_ms: 23.167471
          type: 'test'
          ...
        # Subtest: fails if agent is not in roster
        ok 2 - fails if agent is not in roster
          ---
          duration_ms: 13.168703
          type: 'test'
          ...
        # Subtest: fails if agent is already locked
        ok 3 - fails if agent is already locked
          ---
          duration_ms: 7.725147
          type: 'test'
          ...
        # Subtest: fails if agent is already completed
        ok 4 - fails if agent is already completed
          ---
          duration_ms: 9.092326
          type: 'test'
          ...
        # Subtest: fails if race check is lost
        ok 5 - fails if race check is lost
          ---
          duration_ms: 9.229305
          type: 'test'
          ...
        # Subtest: handles race condition with identical timestamps using eventId tie-breaker (we win)
        ok 6 - handles race condition with identical timestamps using eventId tie-breaker (we win)
          ---
          duration_ms: 21.713025
          type: 'test'
          ...
        # Subtest: handles race condition with identical timestamps using eventId tie-breaker (we lose)
        ok 7 - handles race condition with identical timestamps using eventId tie-breaker (we lose)
          ---
          duration_ms: 9.570502
          type: 'test'
          ...
        # Subtest: dry run does not publish
        ok 8 - dry run does not publish
          ---
          duration_ms: 8.630448
          type: 'test'
          ...
        1..8
    ok 2 - cmdLock
      ---
      duration_ms: 103.500967
      type: 'suite'
      ...
    # Subtest: cmdList
        # Subtest: lists active locks
        ok 1 - lists active locks
          ---
          duration_ms: 0.999877
          type: 'test'
          ...
        # Subtest: warns about unknown agents
        ok 2 - warns about unknown agents
          ---
          duration_ms: 0.466332
          type: 'test'
          ...
        # Subtest: handles no locks
        ok 3 - handles no locks
          ---
          duration_ms: 0.305605
          type: 'test'
          ...
        1..3
    ok 3 - cmdList
      ---
      duration_ms: 1.98722
      type: 'suite'
      ...
    # Subtest: cmdComplete
        # Subtest: successfully completes an active lock
        ok 1 - successfully completes an active lock
          ---
          duration_ms: 1.042177
          type: 'test'
          ...
        # Subtest: fails if no active lock found
        ok 2 - fails if no active lock found
          ---
          duration_ms: 0.471594
          type: 'test'
          ...
        # Subtest: detects already completed task
        ok 3 - detects already completed task
          ---
          duration_ms: 0.331552
          type: 'test'
          ...
        1..3
    ok 4 - cmdComplete
      ---
      duration_ms: 2.101064
      type: 'suite'
      ...
    1..4
ok 37 - src/lib.mjs
  ---
  duration_ms: 115.707613
  type: 'suite'
  ...
# [publish:primary] Publishing to 3 relays (wss://relay-a, wss://relay-b, wss://relay-c)...
# [publish:primary] Publishing to 3 relays (wss://relay-a, wss://relay-b, wss://relay-c)...
# [publish:primary] Publishing to 3 relays (wss://relay-a, wss://relay-b, wss://relay-c)...
# [publish:primary] Publishing to 3 relays (wss://relay-a, wss://relay-b, wss://relay-c)...
#   Published to 1/3 relays (required=1, timeout=25ms)
# [publish:primary] Publishing to 2 relays (wss://relay-a, wss://relay-b)...
# [publish:primary] Publishing to 2 relays (wss://relay-a, wss://relay-b)...
#   Published to 2/2 relays (required=2, timeout=25ms)
# [publish:primary] Publishing to 3 relays (wss://relay-a, wss://relay-b, wss://relay-c)...
# [publish:primary] Publishing to 3 relays (wss://relay-a, wss://relay-b, wss://relay-c)...
# [publish:primary] Publishing to 3 relays (wss://relay-a, wss://relay-b, wss://relay-c)...
# [publish:primary] Publishing to 3 relays (wss://relay-a, wss://relay-b, wss://relay-c)...
#   Published to 2/3 relays (required=2, timeout=25ms)
# (node:3264) ExperimentalWarning: The MockTimers API is an experimental feature and might change at any time
# (Use `node --trace-warnings ...` to show where the warning was created)
# Subtest: ci-resilience lock acquisition under unstable relays
    # Subtest: recovers after all relays are down for an initial outage window
    ok 1 - recovers after all relays are down for an initial outage window
      ---
      duration_ms: 22.809965
      type: 'test'
      ...
    # Subtest: survives intermittent timeout spikes and reaches quorum with bounded retries
    ok 2 - survives intermittent timeout spikes and reaches quorum with bounded retries
      ---
      duration_ms: 2.032651
      type: 'test'
      ...
    # Subtest: handles staggered relay recovery and never exceeds retry budget
    ok 3 - handles staggered relay recovery and never exceeds retry budget
      ---
      duration_ms: 3.382349
      type: 'test'
      ...
    1..3
ok 38 - ci-resilience lock acquisition under unstable relays
  ---
  duration_ms: 29.934194
  type: 'suite'
  ...
# [publish:primary] Publishing to 1 relays (wss://relay-a)...
#   Published to 1/1 relays (required=1, timeout=200ms)
# [publish:primary] Publishing to 1 relays (wss://relay-a)...
# [publish:primary] Publishing to 1 relays (wss://relay-a)...
#   Published to 1/1 relays (required=1, timeout=200ms)
# [publish:primary] Publishing to 1 relays (wss://relay-a)...
# [publish:primary] Publishing to 1 relays (wss://relay-a)...
# [publish:primary] Publishing to 1 relays (wss://relay-a)...
# [publish:primary] Publishing to 1 relays (wss://relay-a)...
# (node:3283) ExperimentalWarning: The MockTimers API is an experimental feature and might change at any time
# (Use `node --trace-warnings ...` to show where the warning was created)
# Subtest: publishLock retry behavior
    # Subtest: succeeds immediately on first attempt without retries
    ok 1 - succeeds immediately on first attempt without retries
      ---
      duration_ms: 7.565342
      type: 'test'
      ...
    # Subtest: retries a transient failure then succeeds within retry budget with bounded jitter
    ok 2 - retries a transient failure then succeeds within retry budget with bounded jitter
      ---
      duration_ms: 2.856277
      type: 'test'
      ...
    # Subtest: returns terminal relay_publish_quorum_failure after exhausting retry budget
    ok 3 - returns terminal relay_publish_quorum_failure after exhausting retry budget
      ---
      duration_ms: 3.26897
      type: 'test'
      ...
    # Subtest: short-circuits non-retryable failures without extra attempts
    ok 4 - short-circuits non-retryable failures without extra attempts
      ---
      duration_ms: 2.063776
      type: 'test'
      ...
    1..4
ok 39 - publishLock retry behavior
  ---
  duration_ms: 17.409739
  type: 'suite'
  ...
# Subtest: lock-ops
    # Subtest: parseLockEvent
        # Subtest: parses a valid lock event correctly
        ok 1 - parses a valid lock event correctly
          ---
          duration_ms: 2.61316
          type: 'test'
          ...
        # Subtest: returns nulls when content is invalid JSON
        ok 2 - returns nulls when content is invalid JSON
          ---
          duration_ms: 0.607351
          type: 'test'
          ...
        # Subtest: returns nulls when required content fields are missing
        ok 3 - returns nulls when required content fields are missing
          ---
          duration_ms: 0.509245
          type: 'test'
          ...
        # Subtest: returns nulls when content is an array (not object)
        ok 4 - returns nulls when content is an array (not object)
          ---
          duration_ms: 0.737734
          type: 'test'
          ...
        1..4
    ok 1 - parseLockEvent
      ---
      duration_ms: 6.071545
      type: 'suite'
      ...
# [publish:primary] Publishing to 2 relays (wss://primary-a, wss://primary-b)...
# [publish:primary] Publishing to 2 relays (wss://primary-a, wss://primary-b)...
#   Published to 2/2 relays (required=1, timeout=200ms)
# [publish:primary] Publishing to 1 relays (wss://primary-down)...
# [publish:primary] Publishing to 1 relays (wss://primary-down)...
# [publish:primary] Publishing to 1 relays (wss://primary-down)...
# [publish:primary] Publishing to 1 relays (wss://primary-bad)...
# [publish:primary] Publishing to 5 relays (relay-timeout, wss://dns, wss://tcp, wss://tls, wss://ws)...
# [publish:primary] Publishing to 2 relays (wss://relay-bad, wss://relay-ok)...
# {"event":"lock_publish_quorum_met","correlationId":"0408fcf9-348b-4332-be1d-b0f10800da9f","attemptId":"691e0a44-522c-44b0-b8c9-e44879fff1fe","publishAttempt":1,"successCount":1,"relayAttemptedCount":2,"requiredSuccesses":1,"timeoutMs":200,"retryTimeline":[{"publishAttempt":1,"successCount":1,"relayAttemptedCount":2,"elapsedMs":1}],"totalElapsedMs":1}
#   Published to 1/2 relays (required=1, timeout=200ms)
# [publish:primary] Publishing to 1 relays (wss://primary-bad)...
# [publish:fallback] Publishing to 1 relays (wss://fallback-ok)...
# {"event":"lock_publish_quorum_met","correlationId":"ee959fec-29f8-4189-9828-dc50a2bec074","attemptId":"9804bf7f-159f-4a2b-9800-1e0f7dbd677d","publishAttempt":1,"successCount":1,"relayAttemptedCount":2,"requiredSuccesses":1,"timeoutMs":200,"retryTimeline":[{"publishAttempt":1,"successCount":1,"relayAttemptedCount":2,"elapsedMs":0}],"totalElapsedMs":0}
#   Published to 1/2 relays (required=1, timeout=200ms)
# [publish:primary] Publishing to 2 relays (wss://bad, wss://healthy)...
# {"event":"lock_publish_quorum_met","correlationId":"a1257742-6fc7-47d9-af7c-d33e8118ed6b","attemptId":"597e25c1-aa4d-434b-ab9e-ee77f7ab4985","publishAttempt":1,"successCount":1,"relayAttemptedCount":2,"requiredSuccesses":1,"timeoutMs":200,"retryTimeline":[{"publishAttempt":1,"successCount":1,"relayAttemptedCount":2,"elapsedMs":0}],"totalElapsedMs":0}
#   Published to 1/2 relays (required=1, timeout=200ms)
# [publish:primary] Publishing to 2 relays (wss://healthy, wss://bad)...
# {"event":"lock_publish_quorum_met","correlationId":"7e8dd50e-bf14-49e3-9d87-43db82ca4c5d","attemptId":"1de54e41-cab6-4fbd-8d3b-e01d03e03e62","publishAttempt":1,"successCount":1,"relayAttemptedCount":2,"requiredSuccesses":1,"timeoutMs":200,"retryTimeline":[{"publishAttempt":1,"successCount":1,"relayAttemptedCount":2,"elapsedMs":0}],"totalElapsedMs":0}
#   Published to 1/2 relays (required=1, timeout=200ms)
# [publish:primary] Publishing to 1 relays (wss://healthy)...
# {"event":"lock_publish_quorum_met","correlationId":"e1babf31-8ee9-4563-bade-7a6d9cbde261","attemptId":"b50cd01a-6c8e-4139-b9f9-7dda0834c39e","publishAttempt":1,"successCount":1,"relayAttemptedCount":1,"requiredSuccesses":1,"timeoutMs":200,"retryTimeline":[{"publishAttempt":1,"successCount":1,"relayAttemptedCount":1,"elapsedMs":0}],"totalElapsedMs":0}
#   Published to 1/1 relays (required=1, timeout=200ms)
# [publish:primary] Publishing to 1 relays (wss://healthy)...
# {"event":"lock_publish_quorum_met","correlationId":"c32bd29a-d817-4283-8247-a9f256a07dbd","attemptId":"55dde37c-29b9-4798-bd47-c6f0233e1150","publishAttempt":1,"successCount":1,"relayAttemptedCount":1,"requiredSuccesses":1,"timeoutMs":200,"retryTimeline":[{"publishAttempt":1,"successCount":1,"relayAttemptedCount":1,"elapsedMs":1}],"totalElapsedMs":1}
#   Published to 1/1 relays (required=1, timeout=200ms)
# [publish:primary] Publishing to 2 relays (wss://primary-a, wss://primary-b)...
# [publish:fallback] Publishing to 1 relays (wss://fallback-healthy)...
# {"event":"lock_publish_quorum_met","correlationId":"9dd08b57-094a-47b7-80fc-de5b22fac5d1","attemptId":"d279eae9-e29c-4b3d-b6d3-e8a40a86ce57","publishAttempt":1,"successCount":1,"relayAttemptedCount":3,"requiredSuccesses":1,"timeoutMs":200,"retryTimeline":[{"publishAttempt":1,"successCount":1,"relayAttemptedCount":3,"elapsedMs":1}],"totalElapsedMs":1}
#   Published to 1/3 relays (required=1, timeout=200ms)
    # Subtest: queryLocks
        # Subtest: falls back to fallback relays when primary query fails
        ok 1 - falls back to fallback relays when primary query fails
          ---
          duration_ms: 32.477414
          type: 'test'
          ...
        1..1
    ok 2 - queryLocks
      ---
      duration_ms: 33.191883
      type: 'suite'
      ...
    # Subtest: publishLock
        # Subtest: retries transient failures and succeeds on a later attempt
        ok 1 - retries transient failures and succeeds on a later attempt
          ---
          duration_ms: 4.735999
          type: 'test'
          ...
        # Subtest: fails after retry budget is exhausted for persistent transient failures
        ok 2 - fails after retry budget is exhausted for persistent transient failures
          ---
          duration_ms: 3.302544
          type: 'test'
          ...
        # Subtest: fails without retry for persistent validation failures
        ok 3 - fails without retry for persistent validation failures
          ---
          duration_ms: 1.15006
          type: 'test'
          ...
        # Subtest: includes per-relay reason categories and retry metadata in failure diagnostics
        ok 4 - includes per-relay reason categories and retry metadata in failure diagnostics
          ---
          duration_ms: 4.462016
          type: 'test'
          ...
        # Subtest: returns success when mixed relay outcomes still satisfy quorum
        ok 5 - returns success when mixed relay outcomes still satisfy quorum
          ---
          duration_ms: 1.784232
          type: 'test'
          ...
        # Subtest: uses fallback relays to satisfy min success quorum
        ok 6 - uses fallback relays to satisfy min success quorum
          ---
          duration_ms: 1.038648
          type: 'test'
          ...
        # Subtest: quarantines repeatedly failing relays and still reaches quorum with one healthy relay
        ok 7 - quarantines repeatedly failing relays and still reaches quorum with one healthy relay
          ---
          duration_ms: 2.175559
          type: 'test'
          ...
        # Subtest: uses fallback and min active pool to reintroduce quarantined relay when needed
        ok 8 - uses fallback and min active pool to reintroduce quarantined relay when needed
          ---
          duration_ms: 1.12155
          type: 'test'
          ...
        1..8
    ok 3 - publishLock
      ---
      duration_ms: 20.599765
      type: 'suite'
      ...
    1..3
ok 40 - lock-ops
  ---
  duration_ms: 61.35185
  type: 'suite'
  ...
# Warning: Failed to read log dir logs/daily: Permission denied
# Subtest: lock-utils
    # Subtest: getCompletedAgents
        # Subtest: returns completed agents for daily cadence
        ok 1 - returns completed agents for daily cadence
          ---
          duration_ms: 2.333539
          type: 'test'
          ...
        # Subtest: returns completed agents for weekly cadence
        ok 2 - returns completed agents for weekly cadence
          ---
          duration_ms: 0.487428
          type: 'test'
          ...
        # Subtest: handles ENOENT gracefully
        ok 3 - handles ENOENT gracefully
          ---
          duration_ms: 0.77527
          type: 'test'
          ...
        # Subtest: logs error for non-ENOENT errors
        ok 4 - logs error for non-ENOENT errors
          ---
          duration_ms: 1.430179
          type: 'test'
          ...
        1..4
    ok 1 - getCompletedAgents
      ---
      duration_ms: 6.084244
      type: 'suite'
      ...
    1..1
ok 41 - lock-utils
  ---
  duration_ms: 6.779053
  type: 'suite'
  ...
# Subtest: main dispatch
    # Subtest: should exit with code 1 if no command provided
    ok 1 - should exit with code 1 if no command provided
      ---
      duration_ms: 1.804846
      type: 'test'
      ...
    # Subtest: should exit with code 1 if unknown command provided
    ok 2 - should exit with code 1 if unknown command provided
      ---
      duration_ms: 0.648179
      type: 'test'
      ...
    # Subtest: should exit with code 1 if check command misses cadence
    ok 3 - should exit with code 1 if check command misses cadence
      ---
      duration_ms: 0.888509
      type: 'test'
      ...
    # Subtest: should exit with code 1 if lock command misses agent
    ok 4 - should exit with code 1 if lock command misses agent
      ---
      duration_ms: 0.767972
      type: 'test'
      ...
    # Subtest: should exit with code 1 if complete command misses agent
    ok 5 - should exit with code 1 if complete command misses agent
      ---
      duration_ms: 0.731095
      type: 'test'
      ...
    # Subtest: should exit with code 1 if proposal command misses subcommand
    ok 6 - should exit with code 1 if proposal command misses subcommand
      ---
      duration_ms: 0.5077
      type: 'test'
      ...
    1..6
ok 42 - main dispatch
  ---
  duration_ms: 122.698001
  type: 'suite'
  ...
# Subtest: listMemories, inspectMemory, pinMemory, and unpinMemory support admin hooks
ok 43 - listMemories, inspectMemory, pinMemory, and unpinMemory support admin hooks
  ---
  duration_ms: 4.198585
  type: 'test'
  ...
# Subtest: triggerPruneDryRun returns candidate metadata without deleting records
ok 44 - triggerPruneDryRun returns candidate metadata without deleting records
  ---
  duration_ms: 0.699807
  type: 'test'
  ...
# Subtest: memoryStats reports counts/rates and retrieval telemetry remains redaction-safe
ok 45 - memoryStats reports counts/rates and retrieval telemetry remains redaction-safe
  ---
  duration_ms: 17.948792
  type: 'test'
  ...
# Subtest: runPruneCycle respects prune feature-flag modes
ok 46 - runPruneCycle respects prune feature-flag modes
  ---
  duration_ms: 0.813408
  type: 'test'
  ...
# Subtest: markMemoryMerged delegates to repository and clears cache
ok 47 - markMemoryMerged delegates to repository and clears cache
  ---
  duration_ms: 0.797492
  type: 'test'
  ...
# Subtest: stores runtime events in signer/session namespace and clears scope
ok 48 - stores runtime events in signer/session namespace and clears scope
  ---
  duration_ms: 2.725047
  type: 'test'
  ...
# Subtest: expires runtime events and records expiration metrics
ok 49 - expires runtime events and records expiration metrics
  ---
  duration_ms: 0.514056
  type: 'test'
  ...
# Subtest: enforces LRU bounds and tracks eviction metrics
ok 50 - enforces LRU bounds and tracks eviction metrics
  ---
  duration_ms: 0.437318
  type: 'test'
  ...
# Subtest: blocks decrypted/session-sensitive data from durable promotion without sanitizer pass
ok 51 - blocks decrypted/session-sensitive data from durable promotion without sanitizer pass
  ---
  duration_ms: 1.638657
  type: 'test'
  ...
# Subtest: createEmbedderAdapter selects in-memory backend and supports vector CRUD
ok 52 - createEmbedderAdapter selects in-memory backend and supports vector CRUD
  ---
  duration_ms: 1.80715
  type: 'test'
  ...
# Subtest: createEmbedderAdapter reads backend from environment
ok 53 - createEmbedderAdapter reads backend from environment
  ---
  duration_ms: 0.480785
  type: 'test'
  ...
# Subtest: memory feature flags parse defaults and canary allow-lists
ok 54 - memory feature flags parse defaults and canary allow-lists
  ---
  duration_ms: 1.694441
  type: 'test'
  ...
# Subtest: memory prune flag supports off, dry-run, and active modes
ok 55 - memory prune flag supports off, dry-run, and active modes
  ---
  duration_ms: 0.410535
  type: 'test'
  ...
# Subtest: estimateTokenCount returns heuristic count
ok 56 - estimateTokenCount returns heuristic count
  ---
  duration_ms: 1.633686
  type: 'test'
  ...
# Subtest: formatMemoryBlock converts memory record to display block
ok 57 - formatMemoryBlock converts memory record to display block
  ---
  duration_ms: 0.784415
  type: 'test'
  ...
# Subtest: formatMemoryBlock handles missing optional fields and default clamping
ok 58 - formatMemoryBlock handles missing optional fields and default clamping
  ---
  duration_ms: 0.222468
  type: 'test'
  ...
# Subtest: formatMemoryBlock respects custom clamping options
ok 59 - formatMemoryBlock respects custom clamping options
  ---
  duration_ms: 0.29058
  type: 'test'
  ...
# Subtest: formatMemoryBlock handles edge cases for clamping
ok 60 - formatMemoryBlock handles edge cases for clamping
  ---
  duration_ms: 0.32293
  type: 'test'
  ...
# Subtest: formatMemoriesForPrompt enforces token budget and k limit
ok 61 - formatMemoriesForPrompt enforces token budget and k limit
  ---
  duration_ms: 0.954257
  type: 'test'
  ...
# Subtest: formatMemoriesForPrompt handles aggressive budget fitting
ok 62 - formatMemoriesForPrompt handles aggressive budget fitting
  ---
  duration_ms: 0.531338
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext injects context when enabled
ok 63 - renderPromptWithMemoryContext injects context when enabled
  ---
  duration_ms: 0.81096
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext returns base prompt when disabled
ok 64 - renderPromptWithMemoryContext returns base prompt when disabled
  ---
  duration_ms: 0.480847
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext handles missing query or service
ok 65 - renderPromptWithMemoryContext handles missing query or service
  ---
  duration_ms: 0.593911
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext handles circular agentContext gracefully
ok 66 - renderPromptWithMemoryContext handles circular agentContext gracefully
  ---
  duration_ms: 0.497248
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext handles agentContext as array of strings
ok 67 - renderPromptWithMemoryContext handles agentContext as array of strings
  ---
  duration_ms: 0.311942
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext handles agentContext as plain object
ok 68 - renderPromptWithMemoryContext handles agentContext as plain object
  ---
  duration_ms: 0.247031
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext handles agentContext as primitives
ok 69 - renderPromptWithMemoryContext handles agentContext as primitives
  ---
  duration_ms: 0.241096
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext calls updateMemoryUsage for retrieved memories
ok 70 - renderPromptWithMemoryContext calls updateMemoryUsage for retrieved memories
  ---
  duration_ms: 2.497543
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext handles empty memories gracefully
ok 71 - renderPromptWithMemoryContext handles empty memories gracefully
  ---
  duration_ms: 0.230382
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext handles null/undefined memories gracefully
ok 72 - renderPromptWithMemoryContext handles null/undefined memories gracefully
  ---
  duration_ms: 0.323024
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext respects TORCH_MEMORY_ENABLED=false
ok 73 - renderPromptWithMemoryContext respects TORCH_MEMORY_ENABLED=false
  ---
  duration_ms: 0.165525
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext respects retrieval allowlist
ok 74 - renderPromptWithMemoryContext respects retrieval allowlist
  ---
  duration_ms: 0.406577
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext passes k and tokenBudget
ok 75 - renderPromptWithMemoryContext passes k and tokenBudget
  ---
  duration_ms: 0.418467
  type: 'test'
  ...
# Subtest: getRelevantMemories uses cached results when available
ok 76 - getRelevantMemories uses cached results when available
  ---
  duration_ms: 2.074876
  type: 'test'
  ...
# Subtest: getRelevantMemories calls ranker and updates cache on miss
ok 77 - getRelevantMemories calls ranker and updates cache on miss
  ---
  duration_ms: 1.222876
  type: 'test'
  ...
# Subtest: getRelevantMemories passes correct parameters to ranker
ok 78 - getRelevantMemories passes correct parameters to ranker
  ---
  duration_ms: 0.922645
  type: 'test'
  ...
# Subtest: getRelevantMemories triggers updateMemoryUsage on repository
ok 79 - getRelevantMemories triggers updateMemoryUsage on repository
  ---
  duration_ms: 0.551983
  type: 'test'
  ...
# Subtest: ingestEvents
    # Subtest: happy path: successfully ingests events
    ok 1 - happy path: successfully ingests events
      ---
      duration_ms: 6.531122
      type: 'test'
      ...
    # Subtest: skips ingestion when feature flag is disabled
    ok 2 - skips ingestion when feature flag is disabled
      ---
      duration_ms: 0.482378
      type: 'test'
      ...
    # Subtest: clears cache after ingestion
    ok 3 - clears cache after ingestion
      ---
      duration_ms: 1.80229
      type: 'test'
      ...
    # Subtest: skips duplicate windows
    ok 4 - skips duplicate windows
      ---
      duration_ms: 1.107461
      type: 'test'
      ...
    # Subtest: propagates repository errors
    ok 5 - propagates repository errors
      ---
      duration_ms: 1.562751
      type: 'test'
      ...
    1..5
ok 80 - ingestEvents
  ---
  duration_ms: 13.146553
  type: 'suite'
  ...
# Subtest: ingestMemoryWindow gathers sources, redacts pii, chunks, embeds, links, and emits telemetry
ok 81 - ingestMemoryWindow gathers sources, redacts pii, chunks, embeds, links, and emits telemetry
  ---
  duration_ms: 6.026487
  type: 'test'
  ...
# Subtest: ingestMemoryWindow dedupes overlapping windows by hashed content + agent + timestamp bucket
ok 82 - ingestMemoryWindow dedupes overlapping windows by hashed content + agent + timestamp bucket
  ---
  duration_ms: 0.748565
  type: 'test'
  ...
# Subtest: pinMemory pins the memory and clears the cache
ok 83 - pinMemory pins the memory and clears the cache
  ---
  duration_ms: 2.797417
  type: 'test'
  ...
# Subtest: pinMemory returns null for non-existent ID but still clears cache
ok 84 - pinMemory returns null for non-existent ID but still clears cache
  ---
  duration_ms: 0.550263
  type: 'test'
  ...
# Subtest: unpinMemory unpins the memory and clears the cache
ok 85 - unpinMemory unpins the memory and clears the cache
  ---
  duration_ms: 0.629654
  type: 'test'
  ...
# Subtest: unpinMemory returns null for non-existent ID but still clears cache
ok 86 - unpinMemory returns null for non-existent ID but still clears cache
  ---
  duration_ms: 0.690838
  type: 'test'
  ...
# Subtest: createLifecyclePlan respects delete safety constraints and logs reasons
ok 87 - createLifecyclePlan respects delete safety constraints and logs reasons
  ---
  duration_ms: 4.01978
  type: 'test'
  ...
# Subtest: createLifecyclePlan condenses near-duplicates and archives merged source records
ok 88 - createLifecyclePlan condenses near-duplicates and archives merged source records
  ---
  duration_ms: 0.972527
  type: 'test'
  ...
# Subtest: applyLifecycleActions executes keep/archive/delete and merge markers
ok 89 - applyLifecycleActions executes keep/archive/delete and merge markers
  ---
  duration_ms: 14.173941
  type: 'test'
  ...
# Subtest: filterAndRankMemories applies metadata filters and composite score
ok 90 - filterAndRankMemories applies metadata filters and composite score
  ---
  duration_ms: 2.942827
  type: 'test'
  ...
# Subtest: formatMemoriesForPrompt returns prompt blocks and enforces token budget trimming
ok 91 - formatMemoriesForPrompt returns prompt blocks and enforces token budget trimming
  ---
  duration_ms: 1.464279
  type: 'test'
  ...
# Subtest: isMemoryRetrievalEnabled supports global toggle and agent canary list
ok 92 - isMemoryRetrievalEnabled supports global toggle and agent canary list
  ---
  duration_ms: 0.454963
  type: 'test'
  ...
# Subtest: renderPromptWithMemoryContext injects bounded memory block before base prompt
ok 93 - renderPromptWithMemoryContext injects bounded memory block before base prompt
  ---
  duration_ms: 0.824715
  type: 'test'
  ...
# Subtest: runPruneCycle respects off mode
ok 94 - runPruneCycle respects off mode
  ---
  duration_ms: 19.928557
  type: 'test'
  ...
# Subtest: runPruneCycle respects dry-run mode
ok 95 - runPruneCycle respects dry-run mode
  ---
  duration_ms: 0.779596
  type: 'test'
  ...
# Subtest: runPruneCycle removes stale unpinned memories in active mode
ok 96 - runPruneCycle removes stale unpinned memories in active mode
  ---
  duration_ms: 4.91217
  type: 'test'
  ...
# Subtest: runPruneCycle starts scheduler if requested
ok 97 - runPruneCycle starts scheduler if requested
  ---
  duration_ms: 1002.826077
  type: 'test'
  ...
# (node:3403) ExperimentalWarning: The MockTimers API is an experimental feature and might change at any time
# (Use `node --trace-warnings ...` to show where the warning was created)
# Subtest: createDbAdvisoryLockProvider acquires and releases postgres advisory locks
ok 98 - createDbAdvisoryLockProvider acquires and releases postgres advisory locks
  ---
  duration_ms: 2.305545
  type: 'test'
  ...
# Subtest: startMemoryMaintenanceScheduler runs all jobs and emits metrics including retries
ok 99 - startMemoryMaintenanceScheduler runs all jobs and emits metrics including retries
  ---
  duration_ms: 9.25029
  type: 'test'
  ...
# Subtest: startMemoryMaintenanceScheduler skips jobs when feature flags disable memory
ok 100 - startMemoryMaintenanceScheduler skips jobs when feature flags disable memory
  ---
  duration_ms: 1.624548
  type: 'test'
  ...
# Subtest: normalizeMemoryItem applies durable schema defaults and coercions
ok 101 - normalizeMemoryItem applies durable schema defaults and coercions
  ---
  duration_ms: 2.462296
  type: 'test'
  ...
# Subtest: validateMemoryItem reports field-level errors
ok 102 - validateMemoryItem reports field-level errors
  ---
  duration_ms: 0.492106
  type: 'test'
  ...
# Subtest: ingestEvents rejects invalid writes and logs structured validation details
ok 103 - ingestEvents rejects invalid writes and logs structured validation details
  ---
  duration_ms: 4.292979
  type: 'test'
  ...
# (node:3421) ExperimentalWarning: The MockTimers API is an experimental feature and might change at any time
# (Use `node --trace-warnings ...` to show where the warning was created)
# Subtest: memoryStats with empty repository returns zero counts and rates
ok 104 - memoryStats with empty repository returns zero counts and rates
  ---
  duration_ms: 2.372514
  type: 'test'
  ...
# Subtest: memoryStats with populated repository returns correct counts and totals
ok 105 - memoryStats with populated repository returns correct counts and totals
  ---
  duration_ms: 0.56918
  type: 'test'
  ...
# Subtest: memoryStats calculates ingest throughput based on window
ok 106 - memoryStats calculates ingest throughput based on window
  ---
  duration_ms: 8.375118
  type: 'test'
  ...
# Subtest: memoryStats reflects deleted count from prune cycle
ok 107 - memoryStats reflects deleted count from prune cycle
  ---
  duration_ms: 9.40998
  type: 'test'
  ...
# Subtest: memoryStats handles windowMs parameter correctly
ok 108 - memoryStats handles windowMs parameter correctly
  ---
  duration_ms: 0.442071
  type: 'test'
  ...
# Subtest: loadMemoryPromptTemplates loads all memory prompt templates from disk
ok 109 - loadMemoryPromptTemplates loads all memory prompt templates from disk
  ---
  duration_ms: 1.481385
  type: 'test'
  ...
# Subtest: summarizeEvents retries with repair prompt when first response is malformed JSON
ok 110 - summarizeEvents retries with repair prompt when first response is malformed JSON
  ---
  duration_ms: 2.10176
  type: 'test'
  ...
# Subtest: summarizeEvents falls back to deterministic minimal summary with conservative importance when parsing fails twice
ok 111 - summarizeEvents falls back to deterministic minimal summary with conservative importance when parsing fails twice
  ---
  duration_ms: 0.569188
  type: 'test'
  ...
# Subtest: telemetry should not log to stdout or stderr by default
ok 112 - telemetry should not log to stdout or stderr by default
  ---
  duration_ms: 69.508653
  type: 'test'
  ...
# Subtest: telemetry should log to stderr when NODE_DEBUG=torch-memory is set
ok 113 - telemetry should log to stderr when NODE_DEBUG=torch-memory is set
  ---
  duration_ms: 63.843717
  type: 'test'
  ...
# Subtest: schema validation covers required fields, coercion, and rejection paths
ok 114 - schema validation covers required fields, coercion, and rejection paths
  ---
  duration_ms: 3.379342
  type: 'test'
  ...
# Subtest: summarizer parser accepts valid json and recovers after malformed json response
ok 115 - summarizer parser accepts valid json and recovers after malformed json response
  ---
  duration_ms: 5.077403
  type: 'test'
  ...
# Subtest: ingest integration persists memory records and links embeddings from event batches
ok 116 - ingest integration persists memory records and links embeddings from event batches
  ---
  duration_ms: 2.603945
  type: 'test'
  ...
# Subtest: retrieval ranking blends semantic, importance, and recency signals
ok 117 - retrieval ranking blends semantic, importance, and recency signals
  ---
  duration_ms: 0.839293
  type: 'test'
  ...
# Subtest: pruner policy protects pins, merges duplicates, and picks archive/delete outcomes
ok 118 - pruner policy protects pins, merges duplicates, and picks archive/delete outcomes
  ---
  duration_ms: 1.449998
  type: 'test'
  ...
# Subtest: scheduler smoke test handles mocked clock and lock contention
ok 119 - scheduler smoke test handles mocked clock and lock contention
  ---
  duration_ms: 13.156628
  type: 'test'
  ...
# Subtest: CLI Smoke Test
    # Subtest: should print usage when no args provided
    ok 1 - should print usage when no args provided
      ---
      duration_ms: 156.697059
      type: 'test'
      ...
    # Subtest: should fail when checking without cadence
    ok 2 - should fail when checking without cadence
      ---
      duration_ms: 156.288667
      type: 'test'
      ...
    # Subtest: should include paused agents in check output
    ok 3 - should include paused agents in check output
      ---
      duration_ms: 225.407147
      type: 'test'
      ...
    1..3
ok 120 - CLI Smoke Test
  ---
  duration_ms: 540.769352
  type: 'suite'
  ...
# Initializing torch in /app/test-gitignore-T3KV34/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-gitignore-T3KV34/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# No package.json found in host root. Skipping script injection.
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-hash
#   - Namespace: test-ns
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-hash&namespace=test-ns&relays=wss%3A%2F%2Frelay.damus.io
# Initializing torch in /app/test-gitignore-existing-lUy4nB/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Updated test-gitignore-existing-lUy4nB/torch/.gitignore: added node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-hash
#   - Namespace: test-ns
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-hash&namespace=test-ns&relays=wss%3A%2F%2Frelay.damus.io
# No package.json found in host root. Skipping script injection.
# Subtest: ops.mjs: cmdInit creates .gitignore with node_modules
ok 121 - ops.mjs: cmdInit creates .gitignore with node_modules
  ---
  duration_ms: 70.270535
  type: 'test'
  ...
# Subtest: ops.mjs: cmdInit appends to existing .gitignore
ok 122 - ops.mjs: cmdInit appends to existing .gitignore
  ---
  duration_ms: 76.327904
  type: 'test'
  ...
# Initializing torch in /app/test-ops-cw3AOV/project1/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-cw3AOV/project1/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-hashtag
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-hashtag&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# No package.json found in host root. Skipping script injection.
# Initializing torch in /app/test-ops-cw3AOV/project2/torch...
# Initializing torch in /app/test-ops-cw3AOV/project3/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-cw3AOV/project3/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# No package.json found in host root. Skipping script injection.
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-hashtag
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-hashtag&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# Updating torch configuration in /app/test-ops-cw3AOV/project3/torch...
# Creating backup at torch/_backups/backup_2026-02-23T16-46-51-478Z...
# Updating application directories...
#   Updated src/
#   Updated bin/
#   Updated dashboard/
#   Updated landing/
#   Updated assets/
#   Updated scripts/
# Updating application files...
#   Updated package.json
#   Updated build.mjs
#   Updated README.md
#   Updated torch-config.example.json
#   Updated TORCH.md
# Updating static files...
#   Updated META_PROMPTS.md
#   Updated scheduler-flow.md
#   Updated daily-scheduler.md
#   Updated weekly-scheduler.md
#   Skipped roster.json (preserved)
# Updating prompts...
#   daily/: 0 added, 0 updated, 23 preserved
#   weekly/: 0 added, 0 updated, 24 preserved
# Update complete.
# Initializing torch in /app/test-ops-cw3AOV/project4/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-cw3AOV/project4/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-hashtag
#   - Namespace: test-namespace
# No package.json found in host root. Skipping script injection.
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-hashtag&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# Updating torch configuration in /app/test-ops-cw3AOV/project4/torch...
# Creating backup at torch/_backups/backup_2026-02-23T16-46-51-597Z...
# Updating application directories...
#   Updated src/
#   Updated bin/
#   Updated dashboard/
#   Updated landing/
#   Updated assets/
#   Updated scripts/
# Updating application files...
#   Updated package.json
#   Updated build.mjs
#   Updated README.md
#   Updated torch-config.example.json
#   Updated TORCH.md
# Updating static files...
#   Updated META_PROMPTS.md
#   Updated scheduler-flow.md
#   Updated daily-scheduler.md
#   Updated weekly-scheduler.md
#   Overwrote roster.json (forced)
# Updating prompts...
#   daily/: 0 added, 23 updated, 0 preserved
#   weekly/: 0 added, 24 updated, 0 preserved
# Update complete.
# Initializing torch in /app/test-ops-cw3AOV/project5/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-cw3AOV/project5/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# No package.json found in host root. Skipping script injection.
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-hashtag
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-hashtag&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# Updating torch configuration in /app/test-ops-cw3AOV/project5/torch...
# Creating backup at torch/_backups/backup_2026-02-23T16-46-51-755Z...
# Updating application directories...
#   Updated src/
#   Updated bin/
#   Updated dashboard/
#   Updated landing/
#   Updated assets/
#   Updated scripts/
# Updating application files...
#   Updated package.json
#   Updated build.mjs
#   Updated README.md
#   Updated torch-config.example.json
#   Updated TORCH.md
# Updating static files...
#   Updated META_PROMPTS.md
#   Updated scheduler-flow.md
#   Updated daily-scheduler.md
#   Updated weekly-scheduler.md
#   Skipped roster.json (preserved)
# Updating prompts...
#   daily/: 0 added, 0 updated, 23 preserved
#   weekly/: 0 added, 0 updated, 24 preserved
# Update complete.
# Initializing torch in /app/test-ops-cw3AOV/project_roster/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-cw3AOV/project_roster/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# Initialization complete.
# You can now customize the files in torch/
# No package.json found in host root. Skipping script injection.
# ‚óè From torch-config.json:
#   - Hashtag: test-hashtag
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-hashtag&namespace=test-namespace&relays=ws%3A%2F%2F127.0.0.1%3A45079
# Subtest: cmdInit creates directory structure and files
ok 123 - cmdInit creates directory structure and files
  ---
  duration_ms: 43.570085
  type: 'test'
  ...
# Subtest: cmdInit fails if directory exists without force
ok 124 - cmdInit fails if directory exists without force
  ---
  duration_ms: 2.298469
  type: 'test'
  ...
# Subtest: cmdUpdate preserves modified prompt
ok 125 - cmdUpdate preserves modified prompt
  ---
  duration_ms: 122.063442
  type: 'test'
  ...
# Subtest: cmdUpdate overwrites prompt with force
ok 126 - cmdUpdate overwrites prompt with force
  ---
  duration_ms: 136.955376
  type: 'test'
  ...
# Subtest: cmdUpdate creates backup
ok 127 - cmdUpdate creates backup
  ---
  duration_ms: 186.028132
  type: 'test'
  ...
# Initializing torch in /app/test-ops-cw3AOV/project_config_init/torch...
# Copying application directories...
#   Copied src/
#   Copied bin/
#   Copied dashboard/
#   Copied landing/
#   Copied assets/
#   Copied scripts/
# Copying application files...
#   Copied package.json
#   Copied build.mjs
#   Copied README.md
#   Copied torch-config.example.json
#   Copied TORCH.md
# Created torch/roster.json
# Created torch/META_PROMPTS.md
# Created torch/scheduler-flow.md
# Created torch/daily-scheduler.md
# Created torch/weekly-scheduler.md
# Created 23 files in torch/prompts/daily/
# Created 24 files in torch/prompts/weekly/
# Created test-ops-cw3AOV/project_config_init/torch/.gitignore with node_modules
# Saved configuration to torch-config.json
# Created torch/TORCH_DASHBOARD.md
# No package.json found in host root. Skipping script injection.
# Initialization complete.
# You can now customize the files in torch/
# ‚óè From torch-config.json:
#   - Hashtag: test-hashtag
#   - Namespace: test-namespace
# https://torch.thepr0m3th3an.net/dashboard/?hashtag=test-hashtag&namespace=test-namespace&relays=wss%3A%2F%2Frelay.damus.io
# Subtest: torch-lock check respects local roster
ok 128 - torch-lock check respects local roster
  ---
  duration_ms: 342.60523
  type: 'test'
  ...
# Subtest: cmdInit creates torch-config.json with random namespace
ok 129 - cmdInit creates torch-config.json with random namespace
  ---
  duration_ms: 57.147891
  type: 'test'
  ...
# [publish:primary] Publishing to 3 relays (ws://127.0.0.1:42171, ws://127.0.0.1:42439, ws://127.0.0.1:45559)...
#   Published to 1/3 relays (required=1, timeout=80ms)
# Subtest: relay fanout quorum integration
    # Subtest: passes with required=1 when one relay succeeds and two fail
# [publish:primary] Publishing to 3 relays (ws://127.0.0.1:40245, ws://127.0.0.1:42673, ws://127.0.0.1:46347)...
    ok 1 - passes with required=1 when one relay succeeds and two fail
      ---
      duration_ms: 143.184534
      type: 'test'
      ...
    # Subtest: fails with quorum error for required=1 when all relays fail
    ok 2 - fails with quorum error for required=1 when all relays fail
      ---
      duration_ms: 92.838235
      type: 'test'
      ...
# [publish:primary] Publishing to 3 relays (ws://127.0.0.1:36029, ws://127.0.0.1:36687, ws://127.0.0.1:38169)...
    # Subtest: fails with required=2 when only one relay succeeds
    ok 3 - fails with required=2 when only one relay succeeds
      ---
      duration_ms: 94.103959
      type: 'test'
      ...
# [publish:primary] Publishing to 3 relays (ws://127.0.0.1:38931, ws://127.0.0.1:39759, ws://127.0.0.1:42363)...
#   Published to 2/3 relays (required=2, timeout=80ms)
    # Subtest: passes when delayed successes reach quorum before timeout
    ok 4 - passes when delayed successes reach quorum before timeout
      ---
      duration_ms: 92.006668
      type: 'test'
      ...
    1..4
ok 130 - relay fanout quorum integration
  ---
  duration_ms: 424.362309
  type: 'suite'
  ...
# Subtest: RelayHealthManager
    # Subtest: should isolate state between instances
    ok 1 - should isolate state between instances
      ---
      duration_ms: 1.168735
      type: 'test'
      ...
    # Subtest: should prioritize relays based on health
    ok 2 - should prioritize relays based on health
      ---
      duration_ms: 1.791727
      type: 'test'
      ...
    # Subtest: should reset state correctly
    ok 3 - should reset state correctly
      ---
      duration_ms: 0.283012
      type: 'test'
      ...
    # Subtest: should cache ranked results and invalidate on outcome
    ok 4 - should cache ranked results and invalidate on outcome
      ---
      duration_ms: 0.713288
      type: 'test'
      ...
    # Subtest: should invalidate cache when time passes quarantine expiry
    ok 5 - should invalidate cache when time passes quarantine expiry
      ---
      duration_ms: 0.463571
      type: 'test'
      ...
    1..5
ok 131 - RelayHealthManager
  ---
  duration_ms: 8.29049
  type: 'suite'
  ...
# Subtest: evaluateAlertThresholds
    # Subtest: Happy Path: No alerts when thresholds are not met
    ok 1 - Happy Path: No alerts when thresholds are not met
      ---
      duration_ms: 1.539678
      type: 'test'
      ...
    # Subtest: All Relays Down: Triggers alert when duration equals threshold
    ok 2 - All Relays Down: Triggers alert when duration equals threshold
      ---
      duration_ms: 0.407346
      type: 'test'
      ...
    # Subtest: All Relays Down: Does NOT trigger alert just below threshold
    ok 3 - All Relays Down: Does NOT trigger alert just below threshold
      ---
      duration_ms: 0.260285
      type: 'test'
      ...
    # Subtest: Success Rate: Triggers alert when rate is strictly below threshold
    ok 4 - Success Rate: Triggers alert when rate is strictly below threshold
      ---
      duration_ms: 0.3267
      type: 'test'
      ...
    # Subtest: Success Rate: Does NOT trigger alert when rate equals threshold
    ok 5 - Success Rate: Does NOT trigger alert when rate equals threshold
      ---
      duration_ms: 0.431893
      type: 'test'
      ...
    # Subtest: Success Rate: Does NOT trigger alert when rate is above threshold
    ok 6 - Success Rate: Does NOT trigger alert when rate is above threshold
      ---
      duration_ms: 0.26465
      type: 'test'
      ...
    # Subtest: Multiple Alerts: Both conditions met
    ok 7 - Multiple Alerts: Both conditions met
      ---
      duration_ms: 0.307228
      type: 'test'
      ...
    # Subtest: Edge Case: Empty history (should not crash)
    ok 8 - Edge Case: Empty history (should not crash)
      ---
      duration_ms: 2.081875
      type: 'test'
      ...
    # Subtest: Edge Case: Empty history but current result is unhealthy
    ok 9 - Edge Case: Empty history but current result is unhealthy
      ---
      duration_ms: 1.186462
      type: 'test'
      ...
    1..9
ok 132 - evaluateAlertThresholds
  ---
  duration_ms: 10.967662
  type: 'test'
  ...
# Subtest: summarizeHistory - basic statistics calculation
ok 133 - summarizeHistory - basic statistics calculation
  ---
  duration_ms: 2.550244
  type: 'test'
  ...
# Subtest: summarizeHistory - handles empty history
ok 134 - summarizeHistory - handles empty history
  ---
  duration_ms: 0.468917
  type: 'test'
  ...
# Subtest: summarizeHistory - respects time window for stats
ok 135 - summarizeHistory - respects time window for stats
  ---
  duration_ms: 0.413772
  type: 'test'
  ...
# Subtest: summarizeHistory - allDownDurationMinutes considers outside window entries
ok 136 - summarizeHistory - allDownDurationMinutes considers outside window entries
  ---
  duration_ms: 0.431755
  type: 'test'
  ...
# Subtest: summarizeHistory - allDownDurationMinutes is null if never healthy
ok 137 - summarizeHistory - allDownDurationMinutes is null if never healthy
  ---
  duration_ms: 0.435684
  type: 'test'
  ...
# Subtest: summarizeHistory - allDownDurationMinutes is 0 if currently healthy
ok 138 - summarizeHistory - allDownDurationMinutes is 0 if currently healthy
  ---
  duration_ms: 3.371911
  type: 'test'
  ...
# Subtest: summarizeHistory - handles malformed entries gracefully
ok 139 - summarizeHistory - handles malformed entries gracefully
  ---
  duration_ms: 0.741329
  type: 'test'
  ...
# Subtest: summarizeHistory - handles valid timestamp but missing summary
ok 140 - summarizeHistory - handles valid timestamp but missing summary
  ---
  duration_ms: 0.202622
  type: 'test'
  ...
# Subtest: summarizeHistory - healthy entry with invalid timestamp results in NaN duration
ok 141 - summarizeHistory - healthy entry with invalid timestamp results in NaN duration
  ---
  duration_ms: 0.856293
  type: 'test'
  ...
# Subtest: Roster (Unit Tests with Dependency Injection)
    # Subtest: returns fallback roster when no configuration or files exist
    ok 1 - returns fallback roster when no configuration or files exist
      ---
      duration_ms: 2.759945
      type: 'test'
      ...
    # Subtest: loads internal module roster if user/cwd rosters are missing
    ok 2 - loads internal module roster if user/cwd rosters are missing
      ---
      duration_ms: 1.521803
      type: 'test'
      ...
    # Subtest: loads roster from torch/roster.json (User Roster) if present
    ok 3 - loads roster from torch/roster.json (User Roster) if present
      ---
      duration_ms: 1.099186
      type: 'test'
      ...
    # Subtest: loads roster from roster.json (CWD Roster) if present and torch/roster.json is missing
    ok 4 - loads roster from roster.json (CWD Roster) if present and torch/roster.json is missing
      ---
      duration_ms: 0.850834
      type: 'test'
      ...
    # Subtest: falls back to default if roster file is malformed
    ok 5 - falls back to default if roster file is malformed
      ---
      duration_ms: 0.4792
      type: 'test'
      ...
    # Subtest: falls back to default if roster file is missing daily/weekly arrays
    ok 6 - falls back to default if roster file is missing daily/weekly arrays
      ---
      duration_ms: 0.557232
      type: 'test'
      ...
    # Subtest: prioritizes environment variables over file and config
    ok 7 - prioritizes environment variables over file and config
      ---
      duration_ms: 1.831218
      type: 'test'
      ...
    # Subtest: prioritizes config over file
    ok 8 - prioritizes config over file
      ---
      duration_ms: 0.455226
      type: 'test'
      ...
    # Subtest: handles multiple items in env var roster
    ok 9 - handles multiple items in env var roster
      ---
      duration_ms: 0.686395
      type: 'test'
      ...
    1..9
ok 142 - Roster (Unit Tests with Dependency Injection)
  ---
  duration_ms: 12.378427
  type: 'suite'
  ...
# Subtest: fails required memory policy when retrieval/storage evidence is missing
ok 143 - fails required memory policy when retrieval/storage evidence is missing
  ---
  duration_ms: 888.140072
  type: 'test'
  ...
# Subtest: accepts required memory policy when markers or artifacts are produced
ok 144 - accepts required memory policy when markers or artifacts are produced
  ---
  duration_ms: 828.495083
  type: 'test'
  ...
# Subtest: records backend failure metadata when lock command exits with code 2
ok 145 - records backend failure metadata when lock command exits with code 2
  ---
  duration_ms: 924.52479
  type: 'test'
  ...
# Subtest: defers backend failures in non-strict mode and reuses idempotency key on successful retry
ok 146 - defers backend failures in non-strict mode and reuses idempotency key on successful retry
  ---
  duration_ms: 558.459365
  type: 'test'
  ...
# Subtest: fails after exceeding non-strict deferral budget
ok 147 - fails after exceeding non-strict deferral budget
  ---
  duration_ms: 180.175321
  type: 'test'
  ...
# Subtest: strict lock mode fails immediately without deferral
ok 148 - strict lock mode fails immediately without deferral
  ---
  duration_ms: 91.540291
  type: 'test'
  ...
# Subtest: skips lock health preflight by default when not enabled
ok 149 - skips lock health preflight by default when not enabled
  ---
  duration_ms: 374.107594
  type: 'test'
  ...
# Subtest: fails scheduler with preflight metadata when lock health preflight is enabled
ok 150 - fails scheduler with preflight metadata when lock health preflight is enabled
  ---
  duration_ms: 127.715207
  type: 'test'
  ...
# Subtest: categorizes unreadable prompt files as prompt_parse_error
ok 151 - categorizes unreadable prompt files as prompt_parse_error
  ---
  duration_ms: 92.738002
  type: 'test'
  ...
# Subtest: categorizes invalid prompt schema as prompt_schema_error
ok 152 - categorizes invalid prompt schema as prompt_schema_error
  ---
  duration_ms: 96.024847
  type: 'test'
  ...
# Subtest: categorizes handoff runtime failures as execution_error
ok 153 - categorizes handoff runtime failures as execution_error
  ---
  duration_ms: 325.805404
  type: 'test'
  ...
# Subtest: retries lock acquisition for backend error and succeeds on a later attempt
ok 154 - retries lock acquisition for backend error and succeeds on a later attempt
  ---
  duration_ms: 372.389756
  type: 'test'
  ...
# Subtest: stops retrying after configured lock backend retries are exhausted
ok 155 - stops retrying after configured lock backend retries are exhausted
  ---
  duration_ms: 104.852144
  type: 'test'
  ...
# Subtest: does not use backend retry flow for exit code 3 lock conflicts
ok 156 - does not use backend retry flow for exit code 3 lock conflicts
  ---
  duration_ms: 392.966449
  type: 'test'
  ...
# Subtest: retries handoff command for retryable network failures and succeeds
ok 157 - retries handoff command for retryable network failures and succeeds
  ---
  duration_ms: 615.891948
  type: 'test'
  ...
# Subtest: uses fallback platform for handoff when primary platform fails
ok 158 - uses fallback platform for handoff when primary platform fails
  ---
  duration_ms: 593.271687
  type: 'test'
  ...
# Subtest: fails before lock acquisition when runner health preflight command fails
ok 159 - fails before lock acquisition when runner health preflight command fails
  ---
  duration_ms: 323.225516
  type: 'test'
  ...
# Subtest: uses exclusion payload from mixed JSON lock:check output
ok 160 - uses exclusion payload from mixed JSON lock:check output
  ---
  duration_ms: 378.466237
  type: 'test'
  ...
# Subtest: runs selected scheduler prompt through configured runner command
ok 161 - runs selected scheduler prompt through configured runner command
  ---
  duration_ms: 325.604989
  type: 'test'
  ...
# Subtest: propagates non-zero runner exit code
ok 162 - propagates non-zero runner exit code
  ---
  duration_ms: 308.022786
  type: 'test'
  ...
# Subtest: scheduler lock backend failure artifact matches required frontmatter schema
ok 163 - scheduler lock backend failure artifact matches required frontmatter schema
  ---
  duration_ms: 107.156786
  type: 'test'
  ...
# Subtest: schema contract catches missing required lock-backend field
ok 164 - schema contract catches missing required lock-backend field
  ---
  duration_ms: 1.929341
  type: 'test'
  ...
# Subtest: schema contract catches misnamed lock-backend key
ok 165 - schema contract catches misnamed lock-backend key
  ---
  duration_ms: 0.546017
  type: 'test'
  ...
# Subtest: lock preflight e2e: successful lock writes completed status snapshot
ok 166 - lock preflight e2e: successful lock writes completed status snapshot
  ---
  duration_ms: 376.026675
  type: 'test'
  ...
# Subtest: lock preflight e2e: exit code 2 quorum failure persists failed backend status and prompt-not-started marker
ok 167 - lock preflight e2e: exit code 2 quorum failure persists failed backend status and prompt-not-started marker
  ---
  duration_ms: 95.336771
  type: 'test'
  ...
# Subtest: lock preflight e2e: non-lock failure exits failed without prompt parse/schema classification
ok 168 - lock preflight e2e: non-lock failure exits failed without prompt parse/schema classification
  ---
  duration_ms: 91.259903
  type: 'test'
  ...
# Subtest: Scheduler Ratchet Logic (Log Checking)
    # Subtest: excludes agents completed today (daily)
    ok 1 - excludes agents completed today (daily)
      ---
      duration_ms: 2.964731
      type: 'test'
      ...
    # Subtest: excludes agents completed this week (weekly)
    ok 2 - excludes agents completed this week (weekly)
      ---
      duration_ms: 0.418634
      type: 'test'
      ...
    # Subtest: combines locked and completed agents in exclusion list
    ok 3 - combines locked and completed agents in exclusion list
      ---
      duration_ms: 0.622548
      type: 'test'
      ...
    # Subtest: ignores logs when --ignore-logs is set
    ok 4 - ignores logs when --ignore-logs is set
      ---
      duration_ms: 0.36589
      type: 'test'
      ...
    # Subtest: handles missing log directory gracefully
    ok 5 - handles missing log directory gracefully
      ---
      duration_ms: 0.466834
      type: 'test'
      ...
    1..5
ok 169 - Scheduler Ratchet Logic (Log Checking)
  ---
  duration_ms: 6.440922
  type: 'suite'
  ...
# Subtest: Scheduler cycle ordering guarantees
    # Subtest: keeps optional preflight before lock-acquire and preserves handoff/artifact/validation/complete ordering
    ok 1 - keeps optional preflight before lock-acquire and preserves handoff/artifact/validation/complete ordering
      ---
      duration_ms: 10.57096
      type: 'test'
      ...
    # Subtest: includes lock backend failure metadata and classifier checkpoints
    ok 2 - includes lock backend failure metadata and classifier checkpoints
      ---
      duration_ms: 2.741329
      type: 'test'
      ...
    1..2
ok 170 - Scheduler cycle ordering guarantees
  ---
  duration_ms: 13.936864
  type: 'suite'
  ...
# Subtest: parseDateValue
    # Subtest: parses a valid ISO string
    ok 1 - parses a valid ISO string
      ---
      duration_ms: 1.024502
      type: 'test'
      ...
    # Subtest: returns null for empty input
    ok 2 - returns null for empty input
      ---
      duration_ms: 0.237256
      type: 'test'
      ...
    # Subtest: returns null for invalid date strings
    ok 3 - returns null for invalid date strings
      ---
      duration_ms: 0.275231
      type: 'test'
      ...
    1..3
ok 171 - parseDateValue
  ---
  duration_ms: 3.030649
  type: 'suite'
  ...
# Subtest: isStrictSchedulerLogFilename
    # Subtest: accepts valid completed log
    ok 1 - accepts valid completed log
      ---
      duration_ms: 0.527923
      type: 'test'
      ...
    # Subtest: accepts valid failed log
    ok 2 - accepts valid failed log
      ---
      duration_ms: 0.235709
      type: 'test'
      ...
    # Subtest: rejects deferred logs
    ok 3 - rejects deferred logs
      ---
      duration_ms: 0.21909
      type: 'test'
      ...
    # Subtest: rejects filenames without timestamp
    ok 4 - rejects filenames without timestamp
      ---
      duration_ms: 0.415797
      type: 'test'
      ...
    # Subtest: rejects plain text files
    ok 5 - rejects plain text files
      ---
      duration_ms: 0.53793
      type: 'test'
      ...
    # Subtest: rejects .scheduler-run-state.json
    ok 6 - rejects .scheduler-run-state.json
      ---
      duration_ms: 0.50659
      type: 'test'
      ...
    1..6
ok 172 - isStrictSchedulerLogFilename
  ---
  duration_ms: 3.359788
  type: 'suite'
  ...
# Subtest: parseAgentFromFilename
    # Subtest: extracts agent name from completed log
    ok 1 - extracts agent name from completed log
      ---
      duration_ms: 2.064033
      type: 'test'
      ...
    # Subtest: extracts agent name from failed log
    ok 2 - extracts agent name from failed log
      ---
      duration_ms: 0.33547
      type: 'test'
      ...
    # Subtest: returns null for invalid filename
    ok 3 - returns null for invalid filename
      ---
      duration_ms: 0.148988
      type: 'test'
      ...
    1..3
ok 173 - parseAgentFromFilename
  ---
  duration_ms: 2.847089
  type: 'suite'
  ...
# Subtest: parseTimestampFromFilename
    # Subtest: parses timestamp from canonical filename
    ok 1 - parses timestamp from canonical filename
      ---
      duration_ms: 0.361504
      type: 'test'
      ...
    # Subtest: returns null for non-canonical filename
    ok 2 - returns null for non-canonical filename
      ---
      duration_ms: 0.114731
      type: 'test'
      ...
    1..2
ok 174 - parseTimestampFromFilename
  ---
  duration_ms: 0.661948
  type: 'suite'
  ...
# Subtest: parseFrontmatterCreatedAt / parseFrontmatterAgent
    # Subtest: reads created_at from frontmatter
    ok 1 - reads created_at from frontmatter
      ---
      duration_ms: 0.571912
      type: 'test'
      ...
    # Subtest: reads agent from frontmatter
    ok 2 - reads agent from frontmatter
      ---
      duration_ms: 0.364822
      type: 'test'
      ...
    # Subtest: returns null when no frontmatter
    ok 3 - returns null when no frontmatter
      ---
      duration_ms: 0.184784
      type: 'test'
      ...
    1..3
ok 175 - parseFrontmatterCreatedAt / parseFrontmatterAgent
  ---
  duration_ms: 1.627789
  type: 'suite'
  ...
# Subtest: buildRecentlyRunExclusionSet ‚Äî scenarios
    # Subtest: SCN-TWG-01: excludes agents with completed logs within 24-hour daily window
    ok 1 - SCN-TWG-01: excludes agents with completed logs within 24-hour daily window
      ---
      duration_ms: 7.026134
      type: 'test'
      ...
    # Subtest: SCN-TWG-02: does NOT exclude agents whose last run is outside the 24-hour window
    ok 2 - SCN-TWG-02: does NOT exclude agents whose last run is outside the 24-hour window
      ---
      duration_ms: 3.479919
      type: 'test'
      ...
    # Subtest: SCN-TWG-03: excludes agents with failed logs within the window
    ok 3 - SCN-TWG-03: excludes agents with failed logs within the window
      ---
      duration_ms: 3.721942
      type: 'test'
      ...
    # Subtest: SCN-TWG-04: cross-midnight scenario ‚Äî agent ran 10 min before midnight, checked 10 min after
    ok 4 - SCN-TWG-04: cross-midnight scenario ‚Äî agent ran 10 min before midnight, checked 10 min after
      ---
      duration_ms: 2.033904
      type: 'test'
      ...
    # Subtest: SCN-TWG-05: uses frontmatter created_at over filename timestamp when both present
    ok 5 - SCN-TWG-05: uses frontmatter created_at over filename timestamp when both present
      ---
      duration_ms: 1.969165
      type: 'test'
      ...
    # Subtest: SCN-TWG-06: weekly window uses 7-day threshold
    ok 6 - SCN-TWG-06: weekly window uses 7-day threshold
      ---
      duration_ms: 3.846665
      type: 'test'
      ...
    # Subtest: SCN-TWG-07: empty log directory returns empty set
    ok 7 - SCN-TWG-07: empty log directory returns empty set
      ---
      duration_ms: 1.02178
      type: 'test'
      ...
    # Subtest: SCN-TWG-08: non-existent directory returns empty set without throwing
    ok 8 - SCN-TWG-08: non-existent directory returns empty set without throwing
      ---
      duration_ms: 1.08564
      type: 'test'
      ...
    # Subtest: SCN-TWG-09: only the most recent log matters ‚Äî agent excluded if any log is within window
    ok 9 - SCN-TWG-09: only the most recent log matters ‚Äî agent excluded if any log is within window
      ---
      duration_ms: 3.109978
      type: 'test'
      ...
    # Subtest: SCN-TWG-10: mixed roster ‚Äî correctly partitions in-window vs out-of-window agents
    ok 10 - SCN-TWG-10: mixed roster ‚Äî correctly partitions in-window vs out-of-window agents
      ---
      duration_ms: 3.529401
      type: 'test'
      ...
    # Subtest: SCN-TWG-11: non-log files in directory are ignored
    ok 11 - SCN-TWG-11: non-log files in directory are ignored
      ---
      duration_ms: 1.935821
      type: 'test'
      ...
    1..11
ok 176 - buildRecentlyRunExclusionSet ‚Äî scenarios
  ---
  duration_ms: 59.126051
  type: 'suite'
  ...
# Subtest: CADENCE_WINDOW_MS constants
    # Subtest: daily window is exactly 24 hours
    ok 1 - daily window is exactly 24 hours
      ---
      duration_ms: 0.211017
      type: 'test'
      ...
    # Subtest: weekly window is exactly 7 days
    ok 2 - weekly window is exactly 7 days
      ---
      duration_ms: 0.109935
      type: 'test'
      ...
    1..2
ok 177 - CADENCE_WINDOW_MS constants
  ---
  duration_ms: 0.467439
  type: 'suite'
  ...
# Subtest: secureRandom
    # Subtest: returns values in [0, 1)
    ok 1 - returns values in [0, 1)
      ---
      duration_ms: 2.696048
      type: 'test'
      ...
    # Subtest: returns varied values
    ok 2 - returns varied values
      ---
      duration_ms: 0.360675
      type: 'test'
      ...
    1..2
ok 178 - secureRandom
  ---
  duration_ms: 5.5975
  type: 'suite'
  ...
# Subtest: summarizes recent lock reliability by platform/cadence/backend/relay
ok 179 - summarizes recent lock reliability by platform/cadence/backend/relay
  ---
  duration_ms: 80.834824
  type: 'test'
  ...
# Subtest: run-flaky-check reports pass/fail counts from TAP output files
ok 180 - run-flaky-check reports pass/fail counts from TAP output files
  ---
  duration_ms: 806.210848
  type: 'test'
  ...
# Subtest: loadTorchConfig (Unit Tests with Mocked FS)
    # Subtest: loads valid config correctly
    ok 1 - loads valid config correctly
      ---
      duration_ms: 3.583101
      type: 'test'
      ...
    # Subtest: returns default config when file is missing
    ok 2 - returns default config when file is missing
      ---
      duration_ms: 0.743801
      type: 'test'
      ...
    # Subtest: throws error on malformed JSON
    ok 3 - throws error on malformed JSON
      ---
      duration_ms: 1.095446
      type: 'test'
      ...
    # Subtest: caches the config and ignores subsequent fs calls
    ok 4 - caches the config and ignores subsequent fs calls
      ---
      duration_ms: 0.779362
      type: 'test'
      ...
    # Subtest: returns null for empty string lists (new consistent behavior)
    ok 5 - returns null for empty string lists (new consistent behavior)
      ---
      duration_ms: 0.833696
      type: 'test'
      ...
    1..5
ok 181 - loadTorchConfig (Unit Tests with Mocked FS)
  ---
  duration_ms: 8.717611
  type: 'suite'
  ...
# Subtest: torch-config
    # Subtest: getTorchConfigPath
        # Subtest: returns default path when env var is not set
        ok 1 - returns default path when env var is not set
          ---
          duration_ms: 1.2168
          type: 'test'
          ...
        # Subtest: returns custom path when env var is set
        ok 2 - returns custom path when env var is set
          ---
          duration_ms: 0.253942
          type: 'test'
          ...
        1..2
    ok 1 - getTorchConfigPath
      ---
      duration_ms: 2.858819
      type: 'suite'
      ...
    # Subtest: parseTorchConfig
        # Subtest: parses new lock backend knobs
        ok 1 - parses new lock backend knobs
          ---
          duration_ms: 1.29813
          type: 'test'
          ...
        1..1
    ok 2 - parseTorchConfig
      ---
      duration_ms: 1.597752
      type: 'suite'
      ...
    # Subtest: loadTorchConfig
        # Subtest: throws fatal error for invalid relay URL
        ok 1 - throws fatal error for invalid relay URL
          ---
          duration_ms: 13.539906
          type: 'test'
          ...
        # Subtest: throws fatal error for invalid timeout range
        ok 2 - throws fatal error for invalid timeout range
          ---
          duration_ms: 2.569504
          type: 'test'
          ...
        # Subtest: throws error for malformed JSON
        ok 3 - throws error for malformed JSON
          ---
          duration_ms: 1.768212
          type: 'test'
          ...
        1..3
    ok 3 - loadTorchConfig
      ---
      duration_ms: 18.887026
      type: 'suite'
      ...
    # Subtest: backend getters
        # Subtest: returns default relays
        ok 1 - returns default relays
          ---
          duration_ms: 3.533953
          type: 'test'
          ...
        # Subtest: validates env knob values
        ok 2 - validates env knob values
          ---
          duration_ms: 2.302296
          type: 'test'
          ...
        1..2
    ok 4 - backend getters
      ---
      duration_ms: 6.294
      type: 'suite'
      ...
    1..4
ok 182 - torch-config
  ---
  duration_ms: 30.553714
  type: 'suite'
  ...
# Subtest: Async Utilities
    # Subtest: withTimeout
        # Subtest: resolves when promise completes before timeout
        ok 1 - resolves when promise completes before timeout
          ---
          duration_ms: 11.669528
          type: 'test'
          ...
        # Subtest: rejects when promise times out
        ok 2 - rejects when promise times out
          ---
          duration_ms: 10.532035
          type: 'test'
          ...
        # Subtest: clears timeout on success
        ok 3 - clears timeout on success
          ---
          duration_ms: 0.359407
          type: 'test'
          ...
        # Subtest: propagates original promise rejection
        ok 4 - propagates original promise rejection
          ---
          duration_ms: 0.47456
          type: 'test'
          ...
        1..4
    ok 1 - withTimeout
      ---
      duration_ms: 24.16462
      type: 'suite'
      ...
    1..1
ok 183 - Async Utilities
  ---
  duration_ms: 24.913992
  type: 'suite'
  ...
# (node:5501) ExperimentalWarning: The MockTimers API is an experimental feature and might change at any time
# (Use `node --trace-warnings ...` to show where the warning was created)
# Subtest: Date Utilities
    # Subtest: todayDateStr
        # Subtest: returns current date in YYYY-MM-DD format
        ok 1 - returns current date in YYYY-MM-DD format
          ---
          duration_ms: 3.324696
          type: 'test'
          ...
        1..1
    ok 1 - todayDateStr
      ---
      duration_ms: 4.200606
      type: 'suite'
      ...
    # Subtest: nowUnix
        # Subtest: returns current unix timestamp
        ok 1 - returns current unix timestamp
          ---
          duration_ms: 0.386212
          type: 'test'
          ...
        1..1
    ok 2 - nowUnix
      ---
      duration_ms: 0.622915
      type: 'suite'
      ...
    # Subtest: getIsoWeekStr
        # Subtest: returns correct ISO week for simple cases
        ok 1 - returns correct ISO week for simple cases
          ---
          duration_ms: 0.334435
          type: 'test'
          ...
        # Subtest: handles year boundaries correctly
        ok 2 - handles year boundaries correctly
          ---
          duration_ms: 0.22085
          type: 'test'
          ...
        # Subtest: handles leap years
        ok 3 - handles leap years
          ---
          duration_ms: 0.275323
          type: 'test'
          ...
        # Subtest: handles empty input (defaults to today)
        ok 4 - handles empty input (defaults to today)
          ---
          duration_ms: 0.339293
          type: 'test'
          ...
        # Subtest: handles invalid input gracefully
        ok 5 - handles invalid input gracefully
          ---
          duration_ms: 0.516139
          type: 'test'
          ...
        1..5
    ok 3 - getIsoWeekStr
      ---
      duration_ms: 2.294237
      type: 'suite'
      ...
    1..3
ok 184 - Date Utilities
  ---
  duration_ms: 7.963764
  type: 'suite'
  ...
# Subtest: Relay Utilities
    # Subtest: mergeRelayList
        # Subtest: merges two lists of relays without duplicates
        ok 1 - merges two lists of relays without duplicates
          ---
          duration_ms: 1.007037
          type: 'test'
          ...
        # Subtest: handles empty lists
        ok 2 - handles empty lists
          ---
          duration_ms: 0.278895
          type: 'test'
          ...
        1..2
    ok 1 - mergeRelayList
      ---
      duration_ms: 1.567029
      type: 'suite'
      ...
    1..1
ok 185 - Relay Utilities
  ---
  duration_ms: 1.817644
  type: 'suite'
  ...
# Subtest: Platform Utilities
    # Subtest: detectPlatform
        # Subtest: detects jules
        ok 1 - detects jules
          ---
          duration_ms: 0.504553
          type: 'test'
          ...
        # Subtest: detects codex
        ok 2 - detects codex
          ---
          duration_ms: 0.15413
          type: 'test'
          ...
        # Subtest: detects goose
        ok 3 - detects goose
          ---
          duration_ms: 0.172774
          type: 'test'
          ...
        # Subtest: detects claude via CLAUDE_API_KEY
        ok 4 - detects claude via CLAUDE_API_KEY
          ---
          duration_ms: 0.128141
          type: 'test'
          ...
        # Subtest: detects claude via ANTHROPIC_API_KEY
        ok 5 - detects claude via ANTHROPIC_API_KEY
          ---
          duration_ms: 0.175363
          type: 'test'
          ...
        # Subtest: detects gemini via GEMINI_API_KEY
        ok 6 - detects gemini via GEMINI_API_KEY
          ---
          duration_ms: 0.147181
          type: 'test'
          ...
        # Subtest: detects gemini via GOOGLE_API_KEY
        ok 7 - detects gemini via GOOGLE_API_KEY
          ---
          duration_ms: 0.124396
          type: 'test'
          ...
        # Subtest: detects antigravity via ANTIGRAVITY_API_KEY
        ok 8 - detects antigravity via ANTIGRAVITY_API_KEY
          ---
          duration_ms: 0.198052
          type: 'test'
          ...
        # Subtest: detects antigravity via ANTIGRAVITY_SESSION_ID
        ok 9 - detects antigravity via ANTIGRAVITY_SESSION_ID
          ---
          duration_ms: 0.131806
          type: 'test'
          ...
        # Subtest: detects qwen via QWEN_API_KEY
        ok 10 - detects qwen via QWEN_API_KEY
          ---
          duration_ms: 0.124903
          type: 'test'
          ...
        # Subtest: returns null if no platform detected
        ok 11 - returns null if no platform detected
          ---
          duration_ms: 0.176851
          type: 'test'
          ...
        1..11
    ok 1 - detectPlatform
      ---
      duration_ms: 2.637901
      type: 'suite'
      ...
    1..1
ok 186 - Platform Utilities
  ---
  duration_ms: 2.760417
  type: 'suite'
  ...
# Subtest: File Utilities
    # Subtest: ensureDir
        # Subtest: creates directory if it does not exist
        ok 1 - creates directory if it does not exist
          ---
          duration_ms: 1.570062
          type: 'test'
          ...
        # Subtest: does nothing if directory already exists
        ok 2 - does nothing if directory already exists
          ---
          duration_ms: 0.251055
          type: 'test'
          ...
        # Subtest: creates nested directories recursively
        ok 3 - creates nested directories recursively
          ---
          duration_ms: 0.267973
          type: 'test'
          ...
        1..3
    ok 1 - ensureDir
      ---
      duration_ms: 3.501641
      type: 'suite'
      ...
    1..1
ok 187 - File Utilities
  ---
  duration_ms: 3.735394
  type: 'suite'
  ...
# Subtest: String Utilities
    # Subtest: relayListLabel
        # Subtest: joins relay URLs with comma and space
        ok 1 - joins relay URLs with comma and space
          ---
          duration_ms: 0.177749
          type: 'test'
          ...
        # Subtest: handles single relay
        ok 2 - handles single relay
          ---
          duration_ms: 0.101162
          type: 'test'
          ...
        # Subtest: handles empty array
        ok 3 - handles empty array
          ---
          duration_ms: 0.090885
          type: 'test'
          ...
        1..3
    ok 1 - relayListLabel
      ---
      duration_ms: 0.499797
      type: 'suite'
      ...
    1..1
ok 188 - String Utilities
  ---
  duration_ms: 0.615497
  type: 'suite'
  ...
# Subtest: passes when artifacts include metadata and failure IDs map to unresolved known issue entries
ok 189 - passes when artifacts include metadata and failure IDs map to unresolved known issue entries
  ---
  duration_ms: 74.273017
  type: 'test'
  ...
# Subtest: fails when required metadata is missing from artifacts
ok 190 - fails when required metadata is missing from artifacts
  ---
  duration_ms: 63.006967
  type: 'test'
  ...
# Subtest: fails when failure identifiers are not cross-linked to known issues or incidents
ok 191 - fails when failure identifiers are not cross-linked to known issues or incidents
  ---
  duration_ms: 67.165861
  type: 'test'
  ...
1..191
# tests 376
# suites 51
# pass 376
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 17232.708554
```

**Command:** `npm run lint`
**Result:**
```

> torch-lock@0.1.0 lint
> eslint .

```
